
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>nodemailer | 元气糯米团子的Coding Blog</title>
  <meta name="author" content="zhiqiang he">
  
  <meta name="description" content="简介nodemailer 是一个 node.js 的邮件客户端库, 常用语服务器端发送邮件.
项目地址:http://www.nodemailer.com
nodemailer 支持的功能:

Unicode
HTML 内容, 纯文本内容
附件
在HTML中嵌入图片
SSL/STARTTLS
transport methods (传输方法)
自定义插件
XOAUTH2">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="nodemailer"/>
  <meta property="og:site_name" content="元气糯米团子的Coding Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="元气糯米团子的Coding Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/assets/css/toc.css"/>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>-->
  <script type="text/javascript" src="//upcdn.b0.upaiyun.com/libs/jquery/jquery-1.8.3.min.js"></script>
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-touch-icon-76x76.png" />
  <link rel="icon" type="image/png" href="favicons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <!--
  <SCRIPT type=text/javascript src="/js/scrolltop.js"></SCRIPT>
   -->
  <!--howiefh calendar begin-->
  <SCRIPT type=text/javascript src="/js/calendar.js"></SCRIPT>
  <!--howiefh calendar end-->
  
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-53429135-1', 'auto');
    ga('send', 'pageview');
</script>

</head>


<body>
<header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">元气糯米团子的Coding Blog</a></h1>
  <h2><a href="/">Tansform information as knowledges, extract and purify as thoughts</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">树根</a></li>
    
      <li><a href="/archives">泡菜坛子</a></li>
    
      <li><a href="/links">连接</a></li>
    
      <li><a href="/atom.xml">粽子</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>

<div id="content" class="inner">
    <div id="main-col" class="alignleft">
        <div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2014-08-01T16:00:00.000Z"><a href="/2014/08/02/nodejs-nodemailer/">2014-08-02</a></time>
      
      
  
    <h1 class="title">nodemailer</h1>
  

    </header>
    <div class="entry">
      


        
        <div id="toc" class="toc-article">
            <strong class="toc-title">文章目录</strong>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#简介"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置"><span class="toc-number">2.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#例子"><span class="toc-number">3.</span> <span class="toc-text">例子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用direct传输"><span class="toc-number">3.1.</span> <span class="toc-text">使用direct传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用默认的SMTP传输"><span class="toc-number">3.2.</span> <span class="toc-text">使用默认的SMTP传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用_transport_插件"><span class="toc-number">3.3.</span> <span class="toc-text">使用 transport 插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Available_Transports"><span class="toc-number">4.</span> <span class="toc-text">Available Transports</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Available_Plugins"><span class="toc-number">5.</span> <span class="toc-text">Available Plugins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sending_mail"><span class="toc-number">6.</span> <span class="toc-text">Sending mail</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#E-mail_message_fields"><span class="toc-number">6.1.</span> <span class="toc-text">E-mail message fields</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#附件"><span class="toc-number">6.2.</span> <span class="toc-text">附件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alternatives"><span class="toc-number">6.3.</span> <span class="toc-text">Alternatives</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#地址格式"><span class="toc-number">6.4.</span> <span class="toc-text">地址格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMTP_信封"><span class="toc-number">6.5.</span> <span class="toc-text">SMTP 信封</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#嵌入图片"><span class="toc-number">6.6.</span> <span class="toc-text">嵌入图片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插件系统"><span class="toc-number">7.</span> <span class="toc-text">插件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#包含插件"><span class="toc-number">7.1.</span> <span class="toc-text">包含插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插件_API"><span class="toc-number">8.</span> <span class="toc-text">插件 API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#resolveContent()"><span class="toc-number">8.1.</span> <span class="toc-text">resolveContent()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#‘compile’"><span class="toc-number">8.2.</span> <span class="toc-text">‘compile’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#‘stream’"><span class="toc-number">8.3.</span> <span class="toc-text">‘stream’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transports"><span class="toc-number">8.4.</span> <span class="toc-text">Transports</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delivering_Bulk_Mail"><span class="toc-number">9.</span> <span class="toc-text">Delivering Bulk Mail</span></a></li></ol>
        </div>
        


        <p><img src="https://raw2.github.com/andris9/Nodemailer/master/assets/nm_logo_200x136.png" alt="nodemailer"></p>
<h2 id="简介">简介</h2><p><code>nodemailer</code> 是一个 <code>node.js</code> 的邮件客户端库, 常用语服务器端发送邮件.</p>
<p>项目地址:<br><a href="http://www.nodemailer.com" target="_blank" rel="external">http://www.nodemailer.com</a></p>
<p><code>nodemailer</code> 支持的功能:</p>
<ul>
<li><code>Unicode</code></li>
<li>HTML 内容, 纯文本内容</li>
<li>附件</li>
<li>在HTML中嵌入图片</li>
<li><code>SSL/STARTTLS</code></li>
<li>transport methods (传输方法)</li>
<li>自定义插件</li>
<li>XOAUTH2</li>
</ul>
<a id="more"></a>
<p>下面是一个发送邮件的例子:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var nodemailer = require(&#39;nodemailer&#39;);&#10;// &#21019;&#24314;&#21487;&#37325;&#29992;&#30340;transporter&#23545;&#35937;&#10;var transporter = nodemailer.createTransport(&#123;&#10;    service: &#39;Gmail&#39;,&#10;    auth: &#123;&#10;        user: &#39;gmail.user@gmail.com&#39;,&#10;        pass: &#39;userpass&#39;&#10;    &#125;&#10;&#125;);&#10;var mailOptions = &#123;&#10;    from: &#39;Fred Foo &#10004; &#60;foo@blurdybloop.com&#62;&#39;, // &#21457;&#20214;&#20154;&#22320;&#22336;&#10;    to: &#39;bar@blurdybloop.com, baz@blurdybloop.com&#39;, // &#25910;&#20214;&#20154;&#22320;&#22336;&#21015;&#34920;&#10;    subject: &#39;Hello &#10004;&#39;, // &#37038;&#20214;&#26631;&#39064;&#10;    text: &#39;Hello world &#10004;&#39;, // &#32431;&#25991;&#26412;&#27491;&#25991;&#10;    html: &#39;&#60;b&#62;Hello world &#10004;&#60;/b&#62;&#39; // HTML&#27491;&#25991;&#10;&#125;;&#10;// &#21457;&#36865;&#10;transporter.sendMail(mailOptions, function(error, info)&#123;&#10;    if(error)&#123;&#10;        console.log(error);&#10;    &#125;else&#123;&#10;        console.log(&#39;Message sent: &#39; + info.response);&#10;    &#125;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="配置">配置</h2><p>用<code>npm</code>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install nodemailer</span><br></pre></td></tr></table></figure>
<p>发送邮件之前,需要创建一个<code>transporter</code>对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var transporter = nodemailer.createTransport(transport);</span><br></pre></td></tr></table></figure>
<p>这里的<code>transporter</code>是一个:</p>
<ul>
<li>作为能够发送邮件的一个对象</li>
<li>一种传输机制, 如果不设置默认使用 <a href="https://github.com/andris9/nodemailer-direct-transport" target="_blank" rel="external">nodemailer-direct-transport</a>, If it is a regular object nodemailer-smtp-transport is used and the value is passed as SMTP configuration.</li>
</ul>
<blockquote>
<p>传输对象只需要创建一次, 并可以在后续的邮件发送操作中重用.</p>
</blockquote>
<h2 id="例子">例子</h2><h3 id="使用direct传输">使用direct传输</h3><p>这种方式是直接发送邮件到接受人的MX 服务器(使用25端口)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var nodemailer = require(&#39;nodemailer&#39;);&#10;var transporter = nodemailer.createTransport();&#10;transporter.sendMail(&#123;&#10;    from: &#39;sender@address&#39;,&#10;    to: &#39;receiver@address&#39;,&#10;    subject: &#39;hello&#39;,&#10;    text: &#39;hello world!&#39;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用 <code>direct</code> 传输机制不是一个可靠的方式, 因为<code>25</code>端口通常被防火墙屏蔽. 从一个<code>动态IP</code>发送的邮件通常被认为是垃圾邮件. 应该考虑使用<code>SMTP</code>.</p>
</blockquote>
<h3 id="使用默认的SMTP传输">使用默认的SMTP传输</h3><p><a href="https://github.com/andris9/nodemailer-smtp-transport#usage" target="_blank" rel="external">SMTP 配置选项</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var nodemailer = require(&#39;nodemailer&#39;);&#10;var transporter = nodemailer.createTransport(&#123;&#10;    service: &#39;gmail&#39;,&#10;    auth: &#123;&#10;        user: &#39;sender@gmail.com&#39;,&#10;        pass: &#39;password&#39;&#10;    &#125;&#10;&#125;);&#10;transporter.sendMail(&#123;&#10;    from: &#39;sender@address&#39;,&#10;    to: &#39;receiver@address&#39;,&#10;    subject: &#39;hello&#39;,&#10;    text: &#39;hello world!&#39;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>默认的SMTP传输并不适合于大规模的邮件发送,每发送一个邮件需要建立一个新的SMTP连接会消耗大量的资源, 如果需要发送大量的邮件,考虑使用 <a href="https://github.com/andris9/nodemailer-smtp-pool" target="_blank" rel="external">nodemailer-smtp-pool</a>.</p>
</blockquote>
<h3 id="使用_transport_插件">使用 transport 插件</h3><h2 id="Available_Transports">Available Transports</h2><p><strong>Built in</strong></p>
<ul>
<li><strong><a href="https://github.com/andris9/nodemailer-smtp-transport" target="_blank" rel="external">nodemailer-smtp-transport</a></strong> for sending messages using a SMTP service</li>
<li><strong><a href="https://github.com/andris9/nodemailer-direct-transport" target="_blank" rel="external">nodemailer-direct-transport</a></strong> for sending messages directly to recipients MX servers (zero configuration needed but unreliable)</li>
</ul>
<p><strong>Install as dependencies</strong></p>
<ul>
<li><strong><a href="https://github.com/andris9/nodemailer-smtp-pool" target="_blank" rel="external">nodemailer-smtp-pool</a></strong> for sending messages to SMTP using pooled connections</li>
<li><strong><a href="https://github.com/andris9/nodemailer-ses-transport" target="_blank" rel="external">nodemailer-ses-transport</a></strong> for sending messages to AWS SES</li>
<li><strong><a href="https://github.com/andris9/nodemailer-sendmail-transport" target="_blank" rel="external">nodemailer-sendmail-transport</a></strong> for piping messages to the <em>sendmail</em> command</li>
<li><strong><a href="https://github.com/andris9/nodemailer-stub-transport" target="_blank" rel="external">nodemailer-stub-transport</a></strong> is just for returning messages, most probably for testing purposes</li>
<li><strong><a href="https://github.com/andris9/nodemailer-pickup-transport" target="_blank" rel="external">nodemailer-pickup-transport</a></strong> for storing messages to pickup folders</li>
<li><em>add yours</em> (see transport api documentation <a href="#transports">here</a>)</li>
</ul>
<h2 id="Available_Plugins">Available Plugins</h2><ul>
<li><strong><a href="https://github.com/andris9/nodemailer-markdown" target="_blank" rel="external">nodemailer-markdown</a></strong> to use markdown for the content</li>
<li><strong><a href="https://github.com/andris9/nodemailer-dkim" target="_blank" rel="external">nodemailer-dkim</a></strong> to sign messages with DKIM</li>
<li><strong><a href="https://github.com/andris9/nodemailer-html-to-text" target="_blank" rel="external">nodemailer-html-to-text</a></strong> to auto generate plaintext content from html</li>
<li><em>add yours</em> (see plugin api documentation <a href="#plugin-api">here</a>)</li>
</ul>
<h2 id="Sending_mail">Sending mail</h2><p>Once you have a transporter object you can send mail</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transporter.sendMail(data, callback)</span><br></pre></td></tr></table></figure>
<p>Where</p>
<ul>
<li><strong>data</strong> defines the mail content (see <a href="#e-mail-message-fields">e-mail message fields</a> below)</li>
<li><strong>callback</strong> is an optional callback function to run once the message is delivered or it failed.<ul>
<li><strong>err</strong> is the error object if message failed</li>
<li><strong>info</strong> includes the result, the exact format depends on the transport mechanism used<ul>
<li><strong>info.messageId</strong> most transports <em>should</em> return the final Message-Id value used with this property</li>
<li><strong>info.envelope</strong> includes the envelope object for the message</li>
<li><strong>info.accepted</strong> is an array returend by SMTP transports (includes recipient addresses that were accepted by the server)</li>
<li><strong>info.rejected</strong> is an array returend by SMTP transports (includes recipient addresses that were rejected by the server)</li>
<li><strong>info.pending</strong> is an array returend by Direct SMTP transport. Includes recipient addresses that were temporarily rejected together with the server response</li>
<li><strong>response</strong> is a string returned by SMTP transports and includes the last SMTP response from the server</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>If the message includes several recipients then the message is considered sent if at least one recipient is accepted</p>
</blockquote>
<h3 id="E-mail_message_fields">E-mail message fields</h3><p>The following are the possible fields of an e-mail message:</p>
<ul>
<li><strong>from</strong> - The e-mail address of the sender. All e-mail addresses can be plain <code>&#39;sender@server.com&#39;</code> or formatted <code>&#39;Sender Name &lt;sender@server.com&gt;&#39;</code>, see <a href="#address-formatting">here</a> for details</li>
<li><strong>to</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>To:</em> field</li>
<li><strong>cc</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>Cc:</em> field</li>
<li><strong>bcc</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>Bcc:</em> field</li>
<li><strong>replyTo</strong> - An e-mail address that will appear on the <em>Reply-To:</em> field</li>
<li><strong>inReplyTo</strong> - The message-id this message is replying</li>
<li><strong>references</strong> - Message-id list (an array or space separated string)</li>
<li><strong>subject</strong> - The subject of the e-mail</li>
<li><strong>text</strong> - The plaintext version of the message as an Unicode string, Buffer, Stream or an object <em>{path: ‘…’}</em></li>
<li><strong>html</strong> - The HTML version of the message as an Unicode string, Buffer, Stream or an object <em>{path: ‘…’}</em></li>
<li><strong>headers</strong> - An object of additional header fields <em>{“X-Key-Name”: “key value”}</em></li>
<li><strong>attachments</strong> - An array of attachment objects  (see <a href="#attachments">below</a> for details)</li>
<li><strong>alternatives</strong> - An array of alternative text contents (in addition to text and html parts)  (see <a href="#alternatives">below</a> for details)</li>
<li><strong>envelope</strong> - optional SMTP envelope, if auto generated envelope is not suitable (see <a href="#smtp-envelope">below</a> for details)</li>
<li><strong>messageId</strong> - optional Message-Id value, random value will be generated if not set</li>
<li><strong>date</strong> - optional Date value, current UTC string will be used if not set</li>
<li><strong>encoding</strong> - optional transfer encoding for the textual parts (defaults to ‘quoted-printable’)</li>
</ul>
<p>All text fields (e-mail addresses, plaintext body, html body) use UTF-8 as the encoding.<br>Attachments are streamed as binary.</p>
<h3 id="附件">附件</h3><p>附件对象由厦门的属性组成:</p>
<ul>
<li><strong>filename</strong> - filename to be reported as the name of the attached file, use of unicode is allowed</li>
<li><strong>cid</strong> - optional content id for using inline images in HTML message source</li>
<li><strong>content</strong> - String, Buffer or a Stream contents for the attachment</li>
<li><strong>path</strong> - path to a file or an URL if you want to stream the file instead of including it (better for larger attachments)</li>
<li><strong>contentType</strong> - optional content type for the attachment, if not set will be derived from the <code>filename</code> property</li>
<li><strong>contentDisposition</strong> - optional content disposition type for the attachment, defaults to ‘attachment’</li>
</ul>
<p>附件可以添加任意多个.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mailOptions = &#123;</span><br><span class="line">    ...</span><br><span class="line">    attachments: [</span><br><span class="line">        &#123;   <span class="comment">// utf-8 string as an attachment</span></span><br><span class="line">            filename: <span class="string">'text1.txt'</span>,</span><br><span class="line">            content: <span class="string">'hello world!'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// binary buffer as an attachment</span></span><br><span class="line">            filename: <span class="string">'text2.txt'</span>,</span><br><span class="line">            content: <span class="keyword">new</span> Buffer(<span class="string">'hello world!'</span>,<span class="string">'utf-8'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// file on disk as an attachment</span></span><br><span class="line">            filename: <span class="string">'text3.txt'</span>,</span><br><span class="line">            path: <span class="string">'/path/to/file.txt'</span> <span class="comment">// stream this file</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// filename and content type is derived from path</span></span><br><span class="line">            path: <span class="string">'/path/to/file.txt'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// stream as an attachment</span></span><br><span class="line">            filename: <span class="string">'text4.txt'</span>,</span><br><span class="line">            content: fs.createReadStream(<span class="string">'file.txt'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// define custom content type for the attachment</span></span><br><span class="line">            filename: <span class="string">'text.bin'</span>,</span><br><span class="line">            content: <span class="string">'hello world!'</span>,</span><br><span class="line">            contentType: <span class="string">'text/plain'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;   <span class="comment">// use URL as an attachment</span></span><br><span class="line">            filename: <span class="string">'license.txt'</span>,</span><br><span class="line">            path: <span class="string">'https://raw.github.com/andris9/Nodemailer/master/LICENSE'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Alternatives">Alternatives</h3><p>In addition to text and HTML, any kind of data can be inserted as an alternative content of the main body - for example a word processing document with the same text as in the HTML field. It is the job of the e-mail client to select and show the best fitting alternative to the reader. Usually this field is used for calendar events and such.</p>
<p>Alternative objects use the same options as <a href="#attachments">attachment objects</a>. The difference between an attachment and an alternative is the fact that attachments are placed into <em>multipart/mixed</em> or <em>multipart/related</em> parts of the message white alternatives are placed into <em>multipart/alternative</em> part.</p>
<p><strong>Usage example:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mailOptions = &#123;</span><br><span class="line">    ...</span><br><span class="line">    html: <span class="string">'&lt;b&gt;Hello world!&lt;/b&gt;'</span>,</span><br><span class="line">    alternatives: [</span><br><span class="line">        &#123;</span><br><span class="line">            contentType: <span class="string">'text/x-web-markdown'</span>,</span><br><span class="line">            content: <span class="string">'**Hello world!**'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Alternatives can be added as many as you want.</p>
<h3 id="地址格式">地址格式</h3><p>所有的邮件地址格式可以是纯电子邮件地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foobar@blurdybloop.com</span><br></pre></td></tr></table></figure>
<p>也可以是带名称的格式(支持Unicode)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#34;&#1053;&#1086;&#1076;&#1077; &#1052;&#1072;&#1081;&#1083;&#1077;&#1088;&#34; &#60;foobar@blurdybloop.com&#62;</span><br></pre></td></tr></table></figure>
<p>还可以是一个地址对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    name: &#39;&#1053;&#1086;&#1076;&#1077; &#1052;&#1072;&#1081;&#1083;&#1077;&#1088;&#39;,&#10;    address: &#39;foobar@blurdybloop.com&#39;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>To, Cc and Bcc fields accept comma separated list of e-mails or an array of<br>e-mails or an array of comma separated list of e-mails - use it as you like.<br>Formatting can be mixed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...,&#10;to: &#39;foobar@blurdybloop.com, &#34;&#1053;&#1086;&#1076;&#1077; &#1052;&#1072;&#1081;&#1083;&#1077;&#1088;&#34; &#60;bar@blurdybloop.com&#62;, &#34;Name, User&#34; &#60;baz@blurdybloop.com&#62;&#39;,&#10;cc: [&#39;foobar@blurdybloop.com&#39;, &#39;&#34;&#1053;&#1086;&#1076;&#1077; &#1052;&#1072;&#1081;&#1083;&#1077;&#1088;&#34; &#60;bar@blurdybloop.com&#62;, &#34;Name, User&#34; &#60;baz@blurdybloop.com&#62;&#39;]&#10;...</span><br></pre></td></tr></table></figure>
<p>You can even use unicode domains, these are automatically converted to punycode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#34;Unicode Domain&#34; &#60;info@m&#252;riaad-pol&#252;teism.info&#62;&#39;</span><br></pre></td></tr></table></figure>
<h3 id="SMTP_信封">SMTP 信封</h3><p>SMTP envelope is usually auto generated from <code>from</code>, <code>to</code>, <code>cc</code> and <code>bcc</code> fields but<br>if for some reason you want to specify it yourself, you can do it with <code>envelope</code> property.</p>
<p><code>envelope</code> is an object with the following params: <code>from</code>, <code>to</code>, <code>cc</code> and <code>bcc</code> just like<br>with regular mail options. You can also use the regular address format, unicode domains etc.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mailOptions = &#123;</span><br><span class="line">    ...,</span><br><span class="line">    from: <span class="string">'mailer@kreata.ee'</span>,</span><br><span class="line">    to: <span class="string">'daemon@kreata.ee'</span>,</span><br><span class="line">    envelope: &#123;</span><br><span class="line">        from: <span class="string">'Daemon &lt;deamon@kreata.ee&gt;'</span>,</span><br><span class="line">        to: <span class="string">'mailer@kreata.ee, Mailer &lt;mailer2@kreata.ee&gt;'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Not all transports can use the <code>envelope</code> object, for example SES ignores it and uses the data from the From:, To: etc. headers.</p>
</blockquote>
<h3 id="嵌入图片">嵌入图片</h3><p>Attachments can be used as embedded images in the HTML body. To use this feature, you need to set additional property of the attachment - <code>cid</code> (unique identifier of the file) which is a reference to the attachment file. The same <code>cid</code> value must be used as the image URL in HTML (using <code>cid:</code> as the URL protocol, see example below).</p>
<p><strong>NB!</strong> the cid value should be as unique as possible!</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mailOptions = &#123;</span><br><span class="line">    ...</span><br><span class="line">    html: <span class="string">'Embedded image: &lt;img src="cid:unique@kreata.ee"/&gt;'</span>,</span><br><span class="line">    attachments: [&#123;</span><br><span class="line">        filename: <span class="string">'image.png'</span>,</span><br><span class="line">        path: <span class="string">'/path/to/file'</span>,</span><br><span class="line">        cid: <span class="string">'unique@kreata.ee'</span> <span class="comment">//same cid value as in the html img src</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="插件系统">插件系统</h2><p>There are 3 stages a plugin can hook to</p>
<ol>
<li><strong>‘compile’</strong> is the step where e-mail data is set but nothing has been done with it yet. At this step you can modify mail options, for example modify <code>html</code> content, add new headers etc. Example: <a href="https://github.com/andris9/nodemailer-markdown" target="_blank" rel="external">nodemailer-markdown</a> that allows you to use <code>markdown</code> source instead of <code>text</code> and <code>html</code>.</li>
<li><strong>‘stream’</strong> is the step where message tree has been compiled and is ready to be streamed. At this step you can modify the generated MIME tree or add a transform stream that the generated raw e-mail will be piped through before passed to the transport object. Example: <a href="https://github.com/andris9/nodemailer-dkim" target="_blank" rel="external">nodemailer-dkim</a> that adds DKIM signature to the generated message.</li>
<li><strong>Transport</strong> step where the raw e-mail is streamed to destination. Example: <a href="https://github.com/andris9/nodemailer-smtp-transport" target="_blank" rel="external">nodemailer-smtp-transport</a> that streams the message to a SMTP server.</li>
</ol>
<h3 id="包含插件">包含插件</h3><p>‘compile’ and ‘stream’ plugins can be attached with <code>use(plugin)</code> method</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transporter.use(step, pluginFunc)</span><br></pre></td></tr></table></figure>
<p>Where</p>
<ul>
<li><strong>transporter</strong> is a transport object created with <code>createTransport</code></li>
<li><strong>step</strong> is a string, either ‘compile’ or ‘stream’ thatd defines when the plugin should be hooked</li>
<li><strong>pluginFunc</strong> is a function that takes two arguments: the mail object and a callback function</li>
</ul>
<h2 id="插件_API">插件 API</h2><p>All plugins (including transports) get two arguments, the mail object and a callback function.</p>
<p>Mail object that is passed to the plugin function as the first argument is an object with the following properties:</p>
<ul>
<li><strong>data</strong> is the mail data object that is passed to the <code>sendMail</code> method</li>
<li><strong>message</strong> is the <a href="https://github.com/andris9/buildmail" target="_blank" rel="external">BuildMail</a> object of the message. This is available for the ‘stream’ step and for the transport but not for ‘compile’.</li>
<li><strong>resolveContent</strong> is a helper function for converting Nodemailer compatible stream objects into Strings or Buffers</li>
</ul>
<h3 id="resolveContent()">resolveContent()</h3><p>If your plugin needs to get the full value of a param, for example the String value for the <code>html</code> content, you can use <code>resolveContent()</code> to convert Nodemailer<br>compatible content objects to Strings or Buffers.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.resolveContent(obj, key, callback)</span><br></pre></td></tr></table></figure>
<p>Where</p>
<ul>
<li><strong>obj</strong> is an object that has a property you want to convert to a String or a Buffer</li>
<li><strong>key</strong> is the name of the property you want to convert</li>
<li><strong>callback</strong> is the callback function with (err, value) where <code>value</code> is either a String or Buffer, depending on the input</li>
</ul>
<p><strong>Example</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plugin</span>(<span class="params">mail, callback</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// if mail.data.html is a file or an url, it is returned as a Buffer</span></span><br><span class="line">    mail.resolveContent(mail.data, <span class="string">'html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, html</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="keyword">return</span> callback(err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'HTML contents: %s'</span>, html.toString());</span><br><span class="line">        callback();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="‘compile’">‘compile’</h3><p>Compile step plugins get only the <code>mail.data</code> object but not <code>mail.message</code> in the <code>mail</code> argument of the plugin function. If you need to access the <code>mail.message</code> as well use ‘stream’ step instead.</p>
<p>This is really straightforward, your plugin can modify the <code>mail.data</code> object at will and once everything is finished run the callback function. If the callback gets an error object as an argument, then the process is terminated and the error is returned to the <code>sendMail</code> callback.</p>
<p><strong>Example</strong></p>
<p>The following plugin checks if <code>text</code> value is set and if not converts <code>html</code> value to <code>text</code> by removing all html tags.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">transporter.use(<span class="string">'compile'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">mail, callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!mail.text &amp;&amp; mail.html)&#123;</span><br><span class="line">        mail.text = mail.html.replace(<span class="regexp">/&lt;[^&gt;]*&gt;/g</span>, <span class="string">' '</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    callback();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>See <a href="examples/plugin-compile.js">plugin-compile.js</a> for a working example.</p>
<h3 id="‘stream’">‘stream’</h3><p>Streaming step is invoked once the message structure is built and ready to be streamed to the transport. Plugin function still gets <code>mail.data</code> but it is included just for the reference, modifying it should not change anything (unless the transport requires something from the <code>mail.data</code>, for example <code>mail.data.envelope</code>).</p>
<p>You can modify the <code>mail.message</code> object as you like, the message is not yet streaming anything (message starts streaming when the transport calls <code>mail.message.createReadStream()</code>).</p>
<p>In most cases you might be interested in the <a href="https://github.com/andris9/buildmail#transform" target="_blank" rel="external">message.transform()</a> method for applying transform streams to the raw message.</p>
<p><strong>Example</strong></p>
<p>下面的插件用空格替换消息中的所有制表符.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> transformer = <span class="keyword">new</span> (<span class="built_in">require</span>(<span class="string">'stream'</span>).Transform)();</span><br><span class="line">transformer._transform = <span class="function"><span class="keyword">function</span>(<span class="params">chunk, encoding, done</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// replace all tabs with spaces in the stream chunk</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; chunk.length; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(chunk[i] === <span class="number">0x09</span>)&#123;</span><br><span class="line">            chunk[i] = <span class="number">0x20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.push(chunk);</span><br><span class="line">    done();</span><br><span class="line">&#125;;</span><br><span class="line">transporter.use(<span class="string">'stream'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">mail, callback</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// apply output transformer to the raw message stream</span></span><br><span class="line">    mail.message.transform(transformer);</span><br><span class="line">    callback();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>See <a href="examples/plugin-stream.js">plugin-stream.js</a> for a working example.</p>
<p>Additionally you might be interested in the <a href="https://github.com/andris9/buildmail#getaddresses" target="_blank" rel="external">message.getAddresses()</a> method that returns the contents for all address fields as structured objects.</p>
<p><strong>例子</strong></p>
<p>The following plugin prints address information to console.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">transporter.use(<span class="string">'stream'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">mail, callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> addresses = mail.message.getAddresses();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'From: %s'</span>, <span class="built_in">JSON</span>.stringify(addresses.from));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'To: %s'</span>, <span class="built_in">JSON</span>.stringify(addresses.to));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Cc: %s'</span>, <span class="built_in">JSON</span>.stringify(addresses.cc));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Bcc: %s'</span>, <span class="built_in">JSON</span>.stringify(addresses.bcc));</span><br><span class="line">    callback();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Transports">Transports</h3><p><code>Transports</code> 是具有方法<code>send</code>和属性<code>name</code>,<code>version</code>的对象. 另外如果<code>transport</code> 对象是一个<code>Event Emitter</code>, <code>log</code> 事件将通过<code>nodemailer</code> 传输. <code>transport</code> 对象传递给 <code>nodemailer.createTransport(transport)</code>方法创建<code>transporter</code>对象</p>
<p><strong><code>transport.name</code></strong></p>
<p><code>transport</code> 对象的名称. 例如 <code>SMTP</code>, <code>SES</code>等.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transport.name = <span class="built_in">require</span>(<span class="string">'package.json'</span>).name;</span><br></pre></td></tr></table></figure>
<p><strong><code>transport.version</code></strong></p>
<p><code>transport</code> 模块的版本, 例如 <code>0.1.0</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transport.version = <span class="built_in">require</span>(<span class="string">'package.json'</span>).version;</span><br></pre></td></tr></table></figure>
<p><strong><code>transport.send(mail, callback)</code></strong></p>
<p>This is the method that actually sends out e-mails. The method is basically the same as ‘stream’ plugin functions. It gets two arguments: <code>mail</code> and a callback. To start streaming the message, create the stream with <code>mail.message.createReadStream()</code></p>
<p>Callback function should return an <code>info</code> object as the second arugment. This info object should contain <code>messageId</code> value with the Message-Id header (without the surrounding &lt; &gt; brackets)</p>
<p>The following example pipes the raw stream to the console.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">transport.send = <span class="function"><span class="keyword">function</span>(<span class="params">mail, callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> input = mail.message.createReadStream();</span><br><span class="line">    <span class="keyword">var</span> messageId = (mail.message.getHeader(<span class="string">'message-id'</span>) || <span class="string">''</span>).replace(<span class="regexp">/[&lt;&gt;\s]/g</span>, <span class="string">''</span>);</span><br><span class="line">    input.pipe(process.stdout);</span><br><span class="line">    input.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        callback(<span class="literal">null</span>, &#123;</span><br><span class="line">            messageId: messageId</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong><code>transport.close(args*)</code></strong></p>
<p>If your transport needs to be closed explicitly, you can implement a <code>close</code> method.</p>
<p>This is purely optional feature and only makes sense in special contexts (eg. closing a SMTP pool).</p>
<p>Once you have a transport object, you can create a mail transporter out of it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var nodemailer = require(&#39;nodemailer&#39;);&#10;var transport = require(&#39;some-transport-method&#39;);&#10;var transporter = nodemailer.createTransport(transport);&#10;transporter.sendMail(&#123;mail data&#125;);</span><br></pre></td></tr></table></figure>
<p>See <a href="examples/minimal-transport.js">minimal-transport.js</a> for a working example.</p>
<h2 id="Delivering_Bulk_Mail">Delivering Bulk Mail</h2><p>Here are some tips how to handle bulk mail, for example if you need to send 10 million messages at once (originally published as a <a href="http://www.andrisreinman.com/delivering-bulk-mail-with-nodemailer/" target="_blank" rel="external">blog post</a>).</p>
<ol>
<li><strong>Use a dedicated SMTP provider.</strong> Do not use services that offer SMTP as a sideline or for free (thats Gmail or the SMTP of your homepage hosting company) to send bulk mail – you’ll hit all the hard limits immediatelly or get labelled as spam. Basically you get what you pay for and if you pay zero then your deliverability is near zero as well. E-mail might seem free but it is only free to a certain amount and that amount certainly does not include 10 million e-mails in a short period of time.</li>
<li><strong>Use a dedicated queue manager,</strong> for example <a href="http://www.rabbitmq.com/" target="_blank" rel="external">RabbitMQ</a> for queueing the e-mails. Nodemailer creates a callback function with related scopes etc. for every message so it might be hard on memory if you pile up the data for 10 million messages at once. Better to take the data from a queue when there’s a free spot in the connection pool (previously sent message returns its callback).</li>
<li><strong>Use <a href="https://github.com/andris9/nodemailer-smtp-pool" target="_blank" rel="external">nodemailer-smtp-pool</a> transport.</strong> You do not want to have the overhead of creating a new connection and doing the SMTP handshake dance for every single e-mail. Pooled connections make it possible to bring this overhead to a minimum.</li>
<li><strong>Set <code>maxMessages</code> option to <code>Infinity</code></strong> for the nodemailer-smtp-pool transport. Dedicated SMTP providers happily accept all your e-mails as long you are paying for these, so no need to disconnect in the middle if everything is going smoothly. The default value is 100 which means that once a connection is used to send 100 messages it is removed from the pool and a new connection is created.</li>
<li><strong>Set <code>maxConnections</code> to whatever your system can handle.</strong> There might be limits to this on the receiving side, so do not set it to <code>Infinity</code>, even 20 is probably much better than the default 5. A larger number means a larger amount of messages are sent in parallel.</li>
<li><strong>Use file paths not URLs for attachments.</strong> If you are reading the same file from the disk several million times, the contents for the file probably get cached somewhere between your app and the physical hard disk, so you get your files back quicker (assuming you send the same attachment to all recipients). There is nothing like this for URLs – every new message makes a fresh HTTP fetch to receive the file from the server.</li>
<li>If the SMTP service accepts HTTP API as well you still might prefer SMTP and not the HTTP API as HTTP introduces additional overhead. You probably want to use HTTP over SMTP if the HTTP API is bulk aware – you send a message template and the list of 10 million recipients and the service compiles this information into e-mails itself, you can’t beat this with SMTP.</li>
</ol>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Node-js/">Node.js</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/nodemailer/">nodemailer</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



</div>
    </div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2015/11/02/elixir-failover-and-takeover/">故障转移和接管</a>
      </li>
    
      <li>
        <a href="/2015/09/17/ejabberd-with-elixir-mix/">用Elixir Mix构建Ejabberd发行包</a>
      </li>
    
      <li>
        <a href="/2015/06/05/uftp/">UFTP - 基于UDP的加密文件多播传输协议</a>
      </li>
    
      <li>
        <a href="/2015/06/04/html5-web-cryptography-api-hashing/">Web加密API - 散列(Hashing)</a>
      </li>
    
      <li>
        <a href="/2015/06/04/the-3-modes-of-http-protocol/">HTTP协议的三种模式</a>
      </li>
    
      <li>
        <a href="/2015/05/21/ejabberd-with-elixir-packet-filters/">Ejabberd 用Elixir开发一个包过滤模块</a>
      </li>
    
      <li>
        <a href="/2015/05/18/chrome-dev-get-started/">Chrome 开发入门</a>
      </li>
    
      <li>
        <a href="/2015/05/18/html5-web-cryptography-api-tutorial/">Web加密API指南</a>
      </li>
    
      <li>
        <a href="/2015/05/17/html5-battery-status/">HTML5获取电池状态</a>
      </li>
    
      <li>
        <a href="/2015/05/10/ejabberd-mam-module-how-to-use/">如何使用Ejabberd消息归档模块</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/AD/">AD</a><small>2</small></li>
  
    <li><a href="/categories/API/">API</a><small>3</small></li>
  
    <li><a href="/categories/Chrome/">Chrome</a><small>1</small></li>
  
    <li><a href="/categories/Continuous-Deployment/">Continuous Deployment</a><small>1</small></li>
  
    <li><a href="/categories/Database/">Database</a><small>1</small></li>
  
    <li><a href="/categories/Docker/">Docker</a><small>9</small></li>
  
    <li><a href="/categories/Ejabberd/">Ejabberd</a><small>36</small></li>
  
    <li><a href="/categories/Elixir/">Elixir</a><small>42</small></li>
  
    <li><a href="/categories/Erlang/">Erlang</a><small>20</small></li>
  
    <li><a href="/categories/HTML5/">HTML5</a><small>3</small></li>
  
    <li><a href="/categories/HTTP/">HTTP</a><small>1</small></li>
  
    <li><a href="/categories/HTTP2/">HTTP2</a><small>1</small></li>
  
    <li><a href="/categories/Javascript/">Javascript</a><small>14</small></li>
  
    <li><a href="/categories/Linux/">Linux</a><small>4</small></li>
  
    <li><a href="/categories/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/categories/Node-js/">Node.js</a><small>17</small></li>
  
    <li><a href="/categories/Opencart/">Opencart</a><small>2</small></li>
  
    <li><a href="/categories/QA/">QA</a><small>2</small></li>
  
    <li><a href="/categories/RESTFul/">RESTFul</a><small>1</small></li>
  
    <li><a href="/categories/SCM/">SCM</a><small>5</small></li>
  
    <li><a href="/categories/Testing/">Testing</a><small>1</small></li>
  
    <li><a href="/categories/Thrift/">Thrift</a><small>1</small></li>
  
    <li><a href="/categories/Tools/">Tools</a><small>4</small></li>
  
    <li><a href="/categories/Web/">Web</a><small>6</small></li>
  
    <li><a href="/categories/XEP/">XEP</a><small>5</small></li>
  
    <li><a href="/categories/XMPP/">XMPP</a><small>7</small></li>
  
    <li><a href="/categories/english/">english</a><small>1</small></li>
  
    <li><a href="/categories/杂类/">杂类</a><small>1</small></li>
  
  </ul>
</div>


  

  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/AD/" style="font-size: 10px;">AD</a> <a href="/tags/API/" style="font-size: 11.11px;">API</a> <a href="/tags/Analysis/" style="font-size: 10px;">Analysis</a> <a href="/tags/Battery-Status/" style="font-size: 10px;">Battery Status</a> <a href="/tags/Behaviour/" style="font-size: 10px;">Behaviour</a> <a href="/tags/CUPS/" style="font-size: 10px;">CUPS</a> <a href="/tags/CURL/" style="font-size: 10px;">CURL</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/Clustering/" style="font-size: 10px;">Clustering</a> <a href="/tags/Distributed/" style="font-size: 10px;">Distributed</a> <a href="/tags/Distributed-Application/" style="font-size: 10px;">Distributed Application</a> <a href="/tags/ETS/" style="font-size: 10px;">ETS</a> <a href="/tags/Ecto/" style="font-size: 11.11px;">Ecto</a> <a href="/tags/Elixir/" style="font-size: 20px;">Elixir</a> <a href="/tags/Erlang/" style="font-size: 10px;">Erlang</a> <a href="/tags/Escalus/" style="font-size: 10px;">Escalus</a> <a href="/tags/ExUnit/" style="font-size: 10px;">ExUnit</a> <a href="/tags/Exrm/" style="font-size: 10px;">Exrm</a> <a href="/tags/H2O/" style="font-size: 10px;">H2O</a> <a href="/tags/Hex-pm/" style="font-size: 10px;">Hex.pm</a> <a href="/tags/HiPE/" style="font-size: 10px;">HiPE</a> <a href="/tags/Howto/" style="font-size: 10px;">Howto</a> <a href="/tags/Http-modes/" style="font-size: 10px;">Http modes</a> <a href="/tags/Httpotion/" style="font-size: 10px;">Httpotion</a> <a href="/tags/I18n/" style="font-size: 10px;">I18n</a> <a href="/tags/IAB/" style="font-size: 10px;">IAB</a> <a href="/tags/ID3/" style="font-size: 10px;">ID3</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/IOT/" style="font-size: 10px;">IOT</a> <a href="/tags/IoT/" style="font-size: 10px;">IoT</a> <a href="/tags/Loopback/" style="font-size: 12.22px;">Loopback</a> <a href="/tags/MUC/" style="font-size: 10px;">MUC</a> <a href="/tags/Macro/" style="font-size: 12.22px;">Macro</a> <a href="/tags/Memcache/" style="font-size: 10px;">Memcache</a> <a href="/tags/Mix/" style="font-size: 14.44px;">Mix</a> <a href="/tags/Modules/" style="font-size: 10px;">Modules</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/OSM-Building/" style="font-size: 10px;">OSM Building</a> <a href="/tags/OTP/" style="font-size: 12.22px;">OTP</a> <a href="/tags/OpenStreetMap/" style="font-size: 10px;">OpenStreetMap</a> <a href="/tags/Optimization/" style="font-size: 10px;">Optimization</a> <a href="/tags/PM2/" style="font-size: 10px;">PM2</a> <a href="/tags/Performance/" style="font-size: 10px;">Performance</a> <a href="/tags/Phoenix/" style="font-size: 12.22px;">Phoenix</a> <a href="/tags/Pool/" style="font-size: 10px;">Pool</a> <a href="/tags/PostgreSQL/" style="font-size: 10px;">PostgreSQL</a> <a href="/tags/RESTFUL/" style="font-size: 11.11px;">RESTFUL</a> <a href="/tags/RMAL/" style="font-size: 10px;">RMAL</a> <a href="/tags/Ranch/" style="font-size: 10px;">Ranch</a> <a href="/tags/RefactorErl/" style="font-size: 10px;">RefactorErl</a> <a href="/tags/Regex/" style="font-size: 10px;">Regex</a> <a href="/tags/Resource-Pool/" style="font-size: 10px;">Resource Pool</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/SSL/" style="font-size: 10px;">SSL</a> <a href="/tags/SemVer/" style="font-size: 10px;">SemVer</a> <a href="/tags/Semantic-UI/" style="font-size: 10px;">Semantic UI</a> <a href="/tags/Sequelize/" style="font-size: 10px;">Sequelize</a> <a href="/tags/Stream-Management/" style="font-size: 10px;">Stream Management</a> <a href="/tags/Sublime/" style="font-size: 10px;">Sublime</a> <a href="/tags/Task/" style="font-size: 10px;">Task</a> <a href="/tags/Thrift/" style="font-size: 11.11px;">Thrift</a> <a href="/tags/Tsung/" style="font-size: 10px;">Tsung</a> <a href="/tags/UBF/" style="font-size: 10px;">UBF</a> <a href="/tags/UFTP/" style="font-size: 10px;">UFTP</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/Umbrella/" style="font-size: 10px;">Umbrella</a> <a href="/tags/VAST/" style="font-size: 10px;">VAST</a> <a href="/tags/VPAID/" style="font-size: 10px;">VPAID</a> <a href="/tags/Web-Cryptography-API/" style="font-size: 11.11px;">Web Cryptography API</a> <a href="/tags/XEP/" style="font-size: 16.67px;">XEP</a> <a href="/tags/XEP-198/" style="font-size: 10px;">XEP-198</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XMPP/" style="font-size: 17.78px;">XMPP</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/angular/" style="font-size: 16.67px;">angular</a> <a href="/tags/application/" style="font-size: 10px;">application</a> <a href="/tags/blockies/" style="font-size: 10px;">blockies</a> <a href="/tags/bootstrap3/" style="font-size: 10px;">bootstrap3</a> <a href="/tags/bosh/" style="font-size: 12.22px;">bosh</a> <a href="/tags/ci/" style="font-size: 10px;">ci</a> <a href="/tags/container/" style="font-size: 11.11px;">container</a> <a href="/tags/data-management/" style="font-size: 10px;">data management</a> <a href="/tags/data-volume/" style="font-size: 10px;">data volume</a> <a href="/tags/debugging/" style="font-size: 10px;">debugging</a> <a href="/tags/devtools/" style="font-size: 10px;">devtools</a> <a href="/tags/devtools-terminal/" style="font-size: 10px;">devtools-terminal</a> <a href="/tags/doc/" style="font-size: 10px;">doc</a> <a href="/tags/docker/" style="font-size: 15.56px;">docker</a> <a href="/tags/ejabberd/" style="font-size: 18.89px;">ejabberd</a> <a href="/tags/ejabberd-c2s/" style="font-size: 10px;">ejabberd_c2s</a> <a href="/tags/emysql/" style="font-size: 11.11px;">emysql</a> <a href="/tags/encoding/" style="font-size: 10px;">encoding</a> <a href="/tags/erlang/" style="font-size: 12.22px;">erlang</a> <a href="/tags/erlang-mk/" style="font-size: 10px;">erlang.mk</a> <a href="/tags/faq/" style="font-size: 10px;">faq</a> <a href="/tags/gen-tcp/" style="font-size: 10px;">gen_tcp</a> <a href="/tags/gerrit/" style="font-size: 11.11px;">gerrit</a> <a href="/tags/gettext/" style="font-size: 10px;">gettext</a> <a href="/tags/git/" style="font-size: 12.22px;">git</a> <a href="/tags/graphviz/" style="font-size: 10px;">graphviz</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hero/" style="font-size: 10px;">hero</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/iconutil/" style="font-size: 10px;">iconutil</a> <a href="/tags/iq/" style="font-size: 10px;">iq</a> <a href="/tags/jabber/" style="font-size: 10px;">jabber</a> <a href="/tags/javascript/" style="font-size: 11.11px;">javascript</a> <a href="/tags/jiffy/" style="font-size: 10px;">jiffy</a> <a href="/tags/json-schema/" style="font-size: 10px;">json-schema</a> <a href="/tags/library/" style="font-size: 10px;">library</a> <a href="/tags/linking/" style="font-size: 10px;">linking</a> <a href="/tags/lists/" style="font-size: 10px;">lists</a> <a href="/tags/load-balance/" style="font-size: 10px;">load balance</a> <a href="/tags/log4er/" style="font-size: 10px;">log4er</a> <a href="/tags/manage-images/" style="font-size: 10px;">manage images</a> <a href="/tags/mariadb/" style="font-size: 10px;">mariadb</a> <a href="/tags/muc/" style="font-size: 10px;">muc</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/node-reggie/" style="font-size: 10px;">node-reggie</a> <a href="/tags/node-webkit/" style="font-size: 13.33px;">node-webkit</a> <a href="/tags/node-js/" style="font-size: 12.22px;">node.js</a> <a href="/tags/nodemailer/" style="font-size: 10px;">nodemailer</a> <a href="/tags/notification/" style="font-size: 10px;">notification</a> <a href="/tags/npm/" style="font-size: 11.11px;">npm</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/ploymer/" style="font-size: 10px;">ploymer</a> <a href="/tags/polymer/" style="font-size: 10px;">polymer</a> <a href="/tags/port/" style="font-size: 10px;">port</a> <a href="/tags/pubsub/" style="font-size: 10px;">pubsub</a> <a href="/tags/rebar/" style="font-size: 10px;">rebar</a> <a href="/tags/record/" style="font-size: 10px;">record</a> <a href="/tags/recursion/" style="font-size: 10px;">recursion</a> <a href="/tags/regexp/" style="font-size: 10px;">regexp</a> <a href="/tags/relx/" style="font-size: 10px;">relx</a> <a href="/tags/screen/" style="font-size: 10px;">screen</a> <a href="/tags/sequelize/" style="font-size: 10px;">sequelize</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/stanza/" style="font-size: 10px;">stanza</a> <a href="/tags/strophe-js/" style="font-size: 10px;">strophe.js</a> <a href="/tags/strophejs/" style="font-size: 10px;">strophejs</a> <a href="/tags/svg-sprite/" style="font-size: 10px;">svg-sprite</a> <a href="/tags/swagger/" style="font-size: 12.22px;">swagger</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a> <a href="/tags/tls/" style="font-size: 10px;">tls</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/tsung/" style="font-size: 10px;">tsung</a> <a href="/tags/upstart/" style="font-size: 10px;">upstart</a> <a href="/tags/vQmod/" style="font-size: 10px;">vQmod</a> <a href="/tags/varnish/" style="font-size: 10px;">varnish</a> <a href="/tags/vqmod/" style="font-size: 10px;">vqmod</a> <a href="/tags/vt/" style="font-size: 10px;">vt</a> <a href="/tags/win32reg/" style="font-size: 10px;">win32reg</a> <a href="/tags/xml-schema/" style="font-size: 10px;">xml schema</a> <a href="/tags/匆匆那年/" style="font-size: 10px;">匆匆那年</a> <a href="/tags/协议包/" style="font-size: 10px;">协议包</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
</div>
<footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 zhiqiang he
  
</div>
<div class="clearfix"></div></footer>

<!--<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>-->
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<!--<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });

</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });

</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });

</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-53429135-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>




