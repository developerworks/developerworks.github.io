
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 2 页 | 元气糯米团子的Coding Blog</title>
  <meta name="author" content="zhiqiang he">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="元气糯米团子的Coding Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="元气糯米团子的Coding Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/assets/css/toc.css"/>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>-->
  <script type="text/javascript" src="//upcdn.b0.upaiyun.com/libs/jquery/jquery-1.8.3.min.js"></script>
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-touch-icon-76x76.png" />
  <link rel="icon" type="image/png" href="favicons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <!--
  <SCRIPT type=text/javascript src="/js/scrolltop.js"></SCRIPT>
   -->
  <!--howiefh calendar begin-->
  <SCRIPT type=text/javascript src="/js/calendar.js"></SCRIPT>
  <!--howiefh calendar end-->
  
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-53429135-1', 'auto');
    ga('send', 'pageview');
</script>

</head>


<body>
<header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">元气糯米团子的Coding Blog</a></h1>
  <h2><a href="/">Tansform information as knowledges, extract and purify as thoughts</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">树根</a></li>
    
      <li><a href="/archives">泡菜坛子</a></li>
    
      <li><a href="/links">连接</a></li>
    
      <li><a href="/atom.xml">粽子</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>

<div id="content" class="inner">
    <div id="main-col" class="alignleft">
        <div id="wrapper">
  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-03-11T05:34:42.000Z"><a href="/2015/03/11/thrift-ex/">2015-03-11</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/11/thrift-ex/">thrift_ex</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>如果用mix构建Erlang项目, 使用<code>mix thrift</code>从<code>.thrift</code>文件生成Erlang代码. 生成的代码保存在<code>src/gen-erl</code>目录中. 还可以在<code>lib/ex_gen</code>生成Elixir包装.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-26T10:13:36.000Z"><a href="/2015/02/26/ejabberd-joins-the-elixir-revolution/">2015-02-26</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/26/ejabberd-joins-the-elixir-revolution/">(译) Ejabberd加入了Elixir的变革</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p><img src="/assets/elixir/ejabberd_elixir.jpg" alt="Ejabberd加入了Elixir的变革"></p>
<p>原文:</p>
<p><a href="https://blog.process-one.net/ejabberd-joins-the-elixir-revolution/" target="_blank" rel="external">https://blog.process-one.net/ejabberd-joins-the-elixir-revolution/</a></p>
<h2 id="前提条件">前提条件</h2><p>安装Erlang R17</p>
<p>克隆Ejabberd源码添加Elixir支持.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:processone/ejabberd.git&#10;cd ejabberd&#10;chmod +x autogen.sh&#10;./autogen.sh&#10;./configure --prefix=$HOME/my-ejabberd --enable-elixir&#10;make &#38;&#38; make install</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/my-ejabberd/&#10;./sbin/ejabberdctl live&#10;&#10;(ejabberd@localhost)1&#62; m(&#39;Elixir.Enum&#39;).&#10;Module &#39;Elixir.Enum&#39; compiled: Date: January 24 2015, Time: 16.27&#10;Compiler options:  [debug_info]&#10;Object file: /Users/mremond/my-ejabberd/lib/ejabberd/ebin/Elixir.Enum.beam&#10;...</span><br></pre></td></tr></table></figure>
<h2 id="用Elixir编写ejabberd插件">用Elixir编写ejabberd插件</h2><p>现在可以用Elixir来编写插件, 并注册钩子扩展ejabberd的功能.</p>
<p>把<code>*.ex</code>插件文件放到ejabberd的<code>lib</code>目录中, 让编译链知道如何编译它们.</p>
<p>在ejabberd的<code>lib/</code>目录中,添加如下文件<code>mod_presence_demo.ex</code>:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">defmodule</span> <span class="title">ModPresenceDemo</span></span> <span class="keyword">do</span></span><br><span class="line">  <span class="variable">@behaviour</span> <span class="symbol">:gen_mod</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">start</span></span>(<span class="constant">_host,</span> <span class="constant">_opts)</span> <span class="keyword">do</span></span><br><span class="line">    <span class="symbol">:ok</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">stop</span></span>(<span class="constant">_host)</span> <span class="keyword">do</span></span><br><span class="line">    <span class="symbol">:ok</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>这是一个最小的ejabberd模块, 为了演示, 我们现在忽略<code>host</code>和<code>options</code>.</p>
<p>当你在Shell中敲入<code>make</code>, 模块应该能够正确的构建. 当执行<code>make install</code>时, 它会被安装到正确的位置.</p>
<p>现在可以在ejabberd配置文件<code>ejabberd.yml</code>中添加模块配置了, 向下面这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modules:&#10;...&#10;  ModPresenceDemo: &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>你可以直接使用模块的名称, Ejabberd会检测到这是一个Elixir模块,并能够正确的使用它.</p>
<p>下面来扩展一下这个模块的功能:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">defmodule</span> <span class="title">ModPresenceDemo</span></span> <span class="keyword">do</span></span><br><span class="line">  import <span class="constant">Ejabberd.Logger </span><span class="comment"># this allow using info, error, etc for logging</span></span><br><span class="line">  <span class="variable">@behaviour</span> <span class="symbol">:gen_mod</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">start</span></span>(host, <span class="constant">_opts)</span> <span class="keyword">do</span></span><br><span class="line">    info(<span class="string">'Starting ejabberd module Presence Demo'</span>)</span><br><span class="line">    <span class="constant">Ejabberd.Hooks.</span>add(<span class="symbol">:set_presence_hook</span>, host, <span class="constant">__ENV__.</span><span class="keyword">module</span>, <span class="symbol">:on_presence</span>, <span class="number">50</span>)</span><br><span class="line">    <span class="symbol">:ok</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">stop</span></span>(host) <span class="keyword">do</span></span><br><span class="line">    info(<span class="string">'Stopping ejabberd module Presence Demo'</span>)</span><br><span class="line">    <span class="constant">Ejabberd.Hooks.</span>delete(<span class="symbol">:set_presence_hook</span>, host, <span class="constant">__ENV__.</span><span class="keyword">module</span>, <span class="symbol">:on_presence</span>, <span class="number">50</span>)</span><br><span class="line">    <span class="symbol">:ok</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">on_presence</span></span>(user, <span class="constant">_server,</span> <span class="constant">_resource,</span> <span class="constant">_packet)</span> <span class="keyword">do</span></span><br><span class="line">    info(<span class="string">'Receive presence for <span class="subst">#&#123;user&#125;</span>'</span>)</span><br><span class="line">    <span class="symbol">:none</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>当启动ejabberd的时候, 应该能够在日志中看到如下输出:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15:17:58.913 [info] Starting ejabberd module Presence Demo test</span><br></pre></td></tr></table></figure>
<p>And anytime an XMPP client changes its presence, you should see the following in the log file:</p>
<p>任何时候, 如果客户端改变其在线状态(presence), 你可以看到如下输出:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15:30:01.266 [info] Receive presence for test</span><br></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="https://blog.process-one.net/elixir-sips-ejabberd-with-elixir-part-1" target="_blank" rel="external">https://blog.process-one.net/elixir-sips-ejabberd-with-elixir-part-1</a></li>
</ol>
<h2 id="修订">修订</h2><ul>
<li>2015-03-18<ul>
<li>添加参考Elixir Sips的视频讲解连接</li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-25T09:16:51.000Z"><a href="/2015/02/25/http2-h2o-get-started/">2015-02-25</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/25/http2-h2o-get-started/">HTTP/2 尝鲜</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>最近发布了HTTP/2的正式标准, 下面通过简单几个步骤尝尝鲜.</p>
<h2 id="软件要求:">软件要求:</h2><ul>
<li>Firefox/36.0 (36.0正式支持HTTP/2)</li>
</ul>
<ul>
<li>H20/1.0</li>
</ul>
<p>编译和安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y cmake&#10;cd /tmp&#10;git clone https://github.com/h2o/h2o.git&#10;cd h2o&#10;cmake -DCMAKE_INSTALL_PREFIX=/usr/local .&#10;make&#10;sudo make install</span><br></pre></td></tr></table></figure>
<ul>
<li>启动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h2o -c examples/h2o/h2o.conf</span><br></pre></td></tr></table></figure>
<ul>
<li>打开Firefox在地址栏中输入:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># HTTP&#10;http://192.168.8.200:8080&#10;# HTTPS&#10;https://192.168.8.200:8081</span><br></pre></td></tr></table></figure>
<p><img src="/assets/http2/487154F3-B4E1-45BA-B157-4B12184FF14C.png" alt="It works"></p>
<h2 id="参考资料">参考资料</h2><ol>
<li>HTTP/2服务器实现清单<br><a href="https://github.com/http2/http2-spec/wiki/Implementations" target="_blank" rel="external">https://github.com/http2/http2-spec/wiki/Implementations</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-12T17:35:15.000Z"><a href="/2015/02/13/ejabberd-escalus/">2015-02-13</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/13/ejabberd-escalus/">Escalus 一个Ejabberd服务器测试工具</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>Escalus 是一个Erlang XMPP客户端库. 它最开始是作为一个XMPP服务器测试工具产生, 但也可以用作独立的Erlang应用程序.</p>
<p>和Tsung这类只做压力测试不验证正确性的工具相比, Escalus的目标是检查服务器行为的正确性.</p>
<h2 id="参考资料">参考资料</h2><ol>
<li>项目仓库<br><a href="https://github.com/esl/escalus" target="_blank" rel="external">https://github.com/esl/escalus</a></li>
<li>简介文档<br><a href="https://github.com/esl/escalus/blob/master/docs/intro.md" target="_blank" rel="external">https://github.com/esl/escalus/blob/master/docs/intro.md</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-12T03:29:17.000Z"><a href="/2015/02/12/erlang-refactoring-your-erlang-module-and-application-with-refactorerl/">2015-02-12</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/12/erlang-refactoring-your-erlang-module-and-application-with-refactorerl/">使用RefactorErl重构你的Erlang模块和应用程序</a></h1>
  

    </header>
    <div class="entry">
      


        
        <div id="toc" class="toc-article">
            <strong class="toc-title">文章目录</strong>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#序"><span class="toc-number">1.</span> <span class="toc-text">序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#简介"><span class="toc-number">2.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编译"><span class="toc-number">3.</span> <span class="toc-text">编译</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Yaws_Web服务器"><span class="toc-number">3.1.</span> <span class="toc-text">安装Yaws Web服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装graphviz"><span class="toc-number">3.2.</span> <span class="toc-text">安装graphviz</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编译RefactorErl"><span class="toc-number">4.</span> <span class="toc-text">编译RefactorErl</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行"><span class="toc-number">5.</span> <span class="toc-text">运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">6.</span> <span class="toc-text">参考资料</span></a></li></ol>
        </div>
        


        <blockquote>
<h2 id="序">序</h2></blockquote>
<p>本文是一篇介绍如何使用工具重构Erlang程序的文章. 本文以分析,阅读和重构Ejabberd 14.12作为示例, 演示如何重构一个现有的Erlang模块, 和应用程序.</p>
<p>本文的演示系统是基于Ubuntu 14.04, 并且带图形界面安装, 后续需要用到的重构工具都需要图形界面, 实际操作前, 请准备好相关的系统环境.</p>
<p>不建议使用非Linux进行本文的实验, 因为非Linux或多或少有一些软件兼容性问题, 会给实验过程带来不必要的麻烦, 如果你的操作系统是非Linux, 可安装VMWare, VirtualBox等虚拟机搭建本文的重构操作需要的实验环境.</p>
<p>本文是一个入门的介绍性文章, 要把RefactorErl用到你的工作中, 还需要阅读大量的相关资料,理解很多概念,请参考文章末尾的参考资料.</p>
<blockquote>
<h2 id="简介">简介</h2></blockquote>
<p>RefactorErl 是一个源代码分析和转换,重构工具, 是欧洲几个大学的联合研究项目, 写作本文的时候, <code>RefactorErl</code>的版本为<code>0.9.14.09</code></p>
<blockquote>
<h2 id="编译">编译</h2></blockquote>
<p>系统环境 Ubuntu 14.04</p>
<h3 id="安装Yaws_Web服务器">安装Yaws Web服务器</h3><p>Yaws Web服务器是构建基于浏览器的重构工具所需要的, 如果需要在浏览器上体验RefactorErl的功能, 需要安装Yaws Web服务器. 官方推荐使用<code>1.95</code>版本的Yaws.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://yaws.hyber.org/download/yaws-1.95.tar.gz&#10;tar zxf yaws-1.95.tar.gz&#10;cd yaws-1.95&#10;# &#32534;&#36753;&#22914;&#19979;&#25991;&#20214;,&#25226;1250&#34892;&#30340; `HashBin = crypto:sha(Salted),`&#10;# &#25913;&#20026; `HashBin = crypto:hash(sha, Salted),` &#21542;&#21017;&#20250;&#23548;&#33268;&#32534;&#35793;&#20986;&#38169;.&#10;vi src/yaws_websocket.erl&#10;./configure&#10;make&#10;make install</span><br></pre></td></tr></table></figure>
<h3 id="安装graphviz">安装graphviz</h3><p>生成模块依赖图需要使用到<code>graphviz</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y graphviz</span><br></pre></td></tr></table></figure>
<blockquote>
<h2 id="编译RefactorErl">编译RefactorErl</h2></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://plc.inf.elte.hu/erlang/dl/refactorerl-0.9.14.09.tar.gz&#10;tar zxf refactorerl-0.9.14.09.tar.gz&#10;cd refactorerl-0.9.14.09&#10;make</span><br></pre></td></tr></table></figure>
<blockquote>
<h2 id="运行">运行</h2></blockquote>
<p>进入RefactorErl Shell执行各种分析操作.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># -db &#21442;&#25968;&#26631;&#35782;&#20351;&#29992;&#30340;&#25968;&#25454;&#24211;&#24341;&#25806;&#10;# &#30446;&#21069;&#25903;&#25345; Mnesia, C++ graph based &#21644; KyotoCabinet based graph &#19977;&#31181;&#23384;&#20648;&#21518;&#31471;&#10;bin/referl -db kcmini</span><br></pre></td></tr></table></figure>
<p>在RefactorErl Shell中设置用于浏览器分析界面的登陆密码</p>
<pre><code>referl_ui_web2:<span class="function"><span class="title">set_web2_pass</span><span class="params">(<span class="string">"admin"</span>, <span class="string">"admin"</span>)</span></span>.
</code></pre><p>命令行方式直接启动Web UI</p>
<pre><code>bin/referl -web2 -yaws_path /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">yaws</span>/<span class="title">ebin</span> -<span class="title">yaws_listen</span> 192.168.8.132 -<span class="title">yaws_port</span> 8001</span>
</code></pre><p>SHELL方式启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ri:start_web2([&#10;    &#123;yaws_path,&#34;/usr/local/lib/yaws/ebin&#34;&#125;,&#10;    &#123;yaws_listen,&#34;192.168.8.132&#34;&#125;,&#10;    &#123;yaws_name , &#34;192.168.8.132&#34;&#125;,&#10;    &#123;yaws_port , &#34;8001&#34;&#125;,&#10;    &#123;browser_root , &#34;/tmp/erlang&#34;&#125;,&#10;    &#123;images_dir , &#34;/tmp/graph_images&#34;&#125;,&#10;    &#123;restricted_mode , true &#125;&#10;]).</span><br></pre></td></tr></table></figure>
<p>在浏览器中打开: <code>http://192.168.8.132:8001/</code></p>
<p>停止</p>
<pre><code>ri:<span class="function"><span class="title">stop_web2</span><span class="params">()</span></span>.
</code></pre><ul>
<li>启动RefactorErl</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/referl -db nif</span><br></pre></td></tr></table></figure>
<ul>
<li>设置Web2密码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">referl_ui_web2:set_web2_pass(&#34;admin&#34;, &#34;admin&#34;).</span><br></pre></td></tr></table></figure>
<ul>
<li>添加文件到数据库引擎</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ri:add(&#34;/root/sources/ejabberd/deps/p1_xml/include/xml.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/deps/esip/include/esip.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/jlib.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/adhoc.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd_config.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd_web_admin.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ELDAPv3.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/jlib.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/mod_muc_room.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/mod_proxy65.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ns.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/XmppAddr.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd_commands.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd_ctl.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/ejabberd_http.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/eldap.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/http_bind.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/logger.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/mod_privacy.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/mod_roster.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/include/pubsub.hrl&#34;).&#10;ri:add(&#34;/root/sources/ejabberd/src&#34;).</span><br></pre></td></tr></table></figure>
<ul>
<li>启动Web2</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ri:start_web2([&#10;    &#123;yaws_path,&#34;/usr/local/lib/yaws/ebin&#34;&#125;,&#10;    &#123;yaws_listen,&#34;192.168.8.102&#34;&#125;,&#10;    &#123;yaws_name , &#34;192.168.8.102&#34;&#125;,&#10;    &#123;yaws_port , &#34;8001&#34;&#125;,&#10;    &#123;browser_root , &#34;/tmp/erlang&#34;&#125;,&#10;    &#123;images_dir , &#34;/tmp/graph_images&#34;&#125;,&#10;    &#123;restricted_mode , true &#125;&#10;]).</span><br></pre></td></tr></table></figure>
<ul>
<li>打开连接</li>
</ul>
<p><a href="http://192.168.8.132:8001" target="_blank" rel="external">http://192.168.8.132:8001</a></p>
<ul>
<li>登陆Web2分析界面</li>
</ul>
<p>用户名: admin<br>密码: admin</p>
<blockquote>
<h2 id="参考资料">参考资料</h2></blockquote>
<ol>
<li>视频介绍<br><a href="https://erlangcentral.org/erlang-factory-2014-refactorerl-supports-your-daily-work" target="_blank" rel="external">https://erlangcentral.org/erlang-factory-2014-refactorerl-supports-your-daily-work</a></li>
<li>项目首页<br><a href="http://plc.inf.elte.hu/erlang/index.html" target="_blank" rel="external">http://plc.inf.elte.hu/erlang/index.html</a></li>
<li>用户手册(PDF)<br><a href="http://plc.inf.elte.hu/erlang/dl/manual_12_01.pdf" target="_blank" rel="external">http://plc.inf.elte.hu/erlang/dl/manual_12_01.pdf</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-07T15:05:51.000Z"><a href="/2015/02/07/nodejs-how-to-use-pm2-to-deploy-a-project/">2015-02-07</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/07/nodejs-how-to-use-pm2-to-deploy-a-project/">如何使用PM2部署一个Node.js项目</a></h1>
  

    </header>
    <div class="entry">
      


        


        <h2 id="创建一个新项目用于部署">创建一个新项目用于部署</h2><p>第一步我们需要创建一个项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir pm2_test &#38;&#38; cd pm2_test&#10;npm init</span><br></pre></td></tr></table></figure>
<p>然后创建初始化一个Express项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">express init</span><br></pre></td></tr></table></figure>
<p>第三步安装依赖模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p>现在一个基本的Express项目就创建好了.</p>
<h2 id="初始化部署配置文件">初始化部署配置文件</h2><p>执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 ecosystem</span><br></pre></td></tr></table></figure>
<p>会在当前目录下生成一个<code>ecosystem.json5</code>文件</p>
<p>重命名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ecosystem.json5 ecosystem.json</span><br></pre></td></tr></table></figure>
<p>编辑<code>ecosystem.json</code>, 设置几个选项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#10;deploy : &#123;&#10;  production : &#123;&#10;    user : &#34;root&#34;,            // &#30331;&#38470;&#29992;&#25143;&#21517;&#10;    host : &#34;servername&#34;,      // &#35201;&#37096;&#32626;&#30340;&#30446;&#26631;&#26381;&#21153;&#22120;IP&#22320;&#22336;&#25110;&#22495;&#21517;&#10;    ref  : &#34;origin/master&#34;,   // &#29992;&#20110;&#37096;&#32626;&#30340;Git&#20179;&#24211;&#20998;&#25903;&#10;    repo : &#34;https://github.com/developerworks/pm2_test.git&#34;,  // Git&#20179;&#24211;&#20301;&#32622;&#10;    path : &#34;/var/www/production&#34;, // &#37096;&#32626;&#30446;&#26631;&#26381;&#21153;&#22120;&#25991;&#20214;&#31995;&#32479;&#20301;&#32622;&#10;    &#34;post-deploy&#34; : &#34;pm2 startOrRestart ecosystem.json --env production&#34;  // &#37096;&#32626;&#21518;&#21551;&#21160;&#10;  &#125;,&#10;&#125;&#10;...</span><br></pre></td></tr></table></figure>
<p>执行部署</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 deploy ecosystem.json production</span><br></pre></td></tr></table></figure>
<p>更新部署</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 deploy production update</span><br></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="https://github.com/Unitech/PM2/blob/development/ADVANCED_README.md" target="_blank" rel="external">https://github.com/Unitech/PM2/blob/development/ADVANCED_README.md</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-07T14:59:27.000Z"><a href="/2015/02/07/copy-ssh-id/">2015-02-07</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/07/copy-ssh-id/">复制公匙到服务器的两种方式</a></h1>
  

    </header>
    <div class="entry">
      


        


        <h2 id="第一种">第一种</h2><p>在有<code>ssh-copy-id</code>工具的系统上, 比如Linux</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id username@domain</span><br></pre></td></tr></table></figure>
<h2 id="第二种">第二种</h2><p>在没有<code>ssh-copy-id</code>工具的系统上, 比如Mac OS X</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub | ssh username@domain &#34;cat &#62;&#62; ~/.ssh/authorized_keys&#34;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-02-01T04:11:23.000Z"><a href="/2015/02/01/elixir-etco-intro/">2015-02-01</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/01/elixir-etco-intro/">Etco 简介</a></h1>
  

    </header>
    <div class="entry">
      


        
        <div id="toc" class="toc-article">
            <strong class="toc-title">文章目录</strong>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ecto_简介"><span class="toc-number">1.</span> <span class="toc-text">Ecto 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主要组件"><span class="toc-number">2.</span> <span class="toc-text">主要组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ecto_库"><span class="toc-number">2.1.</span> <span class="toc-text">Ecto 库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ecto_模型"><span class="toc-number">2.2.</span> <span class="toc-text">Ecto 模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询(Query)"><span class="toc-number">2.3.</span> <span class="toc-text">查询(Query)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移植(Migration)"><span class="toc-number">2.4.</span> <span class="toc-text">移植(Migration)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建项目"><span class="toc-number">3.</span> <span class="toc-text">创建项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Ecto"><span class="toc-number">3.1.</span> <span class="toc-text">安装Ecto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加库(Repository)"><span class="toc-number">3.2.</span> <span class="toc-text">添加库(Repository)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加模型(Models)"><span class="toc-number">3.3.</span> <span class="toc-text">添加模型(Models)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成移植(Migration)脚本"><span class="toc-number">3.4.</span> <span class="toc-text">生成移植(Migration)脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移植"><span class="toc-number">3.5.</span> <span class="toc-text">移植</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实际操作"><span class="toc-number">3.6.</span> <span class="toc-text">实际操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">5.</span> <span class="toc-text">参考资料</span></a></li></ol>
        </div>
        


        <h2 id="Ecto_简介">Ecto 简介</h2><p>Ecto是一种领域语言(DSL), 用于在Elixir中编写数据库查询,和其他数据库操作. Ecto是用Elixir语言开发的一个关系型数据库工具.</p>
<p>本章主要介绍如何在Elixir项目中使用Ecto</p>
<h2 id="主要组件">主要组件</h2><p>Ecto有三个主要组件: 库(Repositories), 模型(Models), 和查询(Queries)</p>
<h3 id="Ecto_库">Ecto 库</h3><p>库是一个数据库的封装, 可以通过如下方式定义一个库:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Repo do&#10;    use Ecto.Repo, adapter: Ecto.Adapters.Postgres&#10;    def conf do&#10;        parse_url &#34;ecto://username:password@localhost/ecto_simple&#34;&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>Ecto当前仅支持Postgresql数据库, 未来会支持其他数据库.</p>
<p>在Ecto中每个库通过定义一个<code>start_link/0</code>函数, 该函数需要在使用库(Repository)之前调用. 该函数不会直接调用, 而是通过一个<code>supervisor</code>链.<br>找到<code>supervisor.ex</code>并使用下面的<code>init/1</code>函数启动一个<code>supervisor</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def init([]) do&#10;    tree = [worker(Repo, [])]&#10;    supervise(tree, strategy: :one_for_all)&#10;end</span><br></pre></td></tr></table></figure>
<h3 id="Ecto_模型">Ecto 模型</h3><p>模型是用于定义在查询,验证和回调中使用的模式(Schema), 下面是一个模式定义的例子:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Weather do&#10;    use Ecto.Model&#10;    # weather is the DB table&#10;    schema &#34;weather&#34; do&#10;        field :city,    :string&#10;        field :temp_lo, :integer&#10;        field :temp_hi, :integer&#10;        field :prcp,    :float, default: 0.0&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>还可以定义<code>primary_key</code>, <code>foreign_key</code> <code>belongs_to</code>等. 模式的详细信息可<a href="http://elixir-lang.org/docs/ecto/Ecto.Model.Schema.html" target="_blank" rel="external">查看文档</a>.</p>
<p>定义了模式后, Ecto自动地定义一个包含模式字段的结构:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weather = %Weather&#123;temp_lo: 30&#125;&#10;weather.temp_lo #=&#62; 30</span><br></pre></td></tr></table></figure>
<p>模型和数据库交互:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weather = %Weather&#123;temp_lo: 0, temp_hi: 23&#125;&#10;Repo.insert(weather)</span><br></pre></td></tr></table></figure>
<p>插入数据库, 返回一个<code>weather</code>的拷贝, 可以通过返回的这个值从数据库中读取一个结构:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># &#35835;&#21462;&#25968;&#25454;&#10;weather = Repo.get Weather, 1&#10;#=&#62; %Weather&#123;id: 1, ...&#125;&#10;# &#26356;&#26032;&#10;weather = %&#123;weather | temp_lo: 10&#125;&#10;Repo.update(weather)&#10;#=&#62; :ok&#10;# &#21024;&#38500;&#10;Repo.delete(weather)</span><br></pre></td></tr></table></figure>
<h3 id="查询(Query)">查询(Query)</h3><p>最后一个组件让我们可以编写查询,并向Repository执行查询.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import Ecto.Query&#10;query = from w in Weather,&#10;        where w.prcp &#62; 0 or w.prcp == nil,&#10;        select w&#10;Repo.all(query)</span><br></pre></td></tr></table></figure>
<h3 id="移植(Migration)">移植(Migration)</h3><p>Ecto还支持数据库移植SQL脚本. 为了生成一个新的移植脚本, 需要高数ecto移植脚本在哪里(哪个目录, 相对于项目根目录).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Repo do&#10;    use Ecto.Repo, adapter: Ecto.Adapters.Postgres&#10;    def priv do&#10;        app_dir(:YOUR_APP_NAME, &#34;priv/repo&#34;)&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>然后, 可以通过<code>mix</code>工具生成移植脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix ecto.gen.migration Repo create_posts</span><br></pre></td></tr></table></figure>
<p>该命令会在<code>priv/repo/migrations</code>目录中生成一个新的文件. 需要编写一个SQL命令来创建表结构, 已经创建一个删除表的命令.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Repo.CreatePosts do&#10;  use Ecto.Migration&#10;  def up do&#10;    [ &#34;CREATE TABLE IF NOT EXISTS migrations_test(id serial primary key, name text)&#34;,&#10;      &#34;INSERT INTO migrations_test (name) VALUES (&#39;inserted&#39;)&#34; ]&#10;  end&#10;  def down do&#10;    &#34;DROP TABLE migrations_test&#34;&#10;  end&#10;end</span><br></pre></td></tr></table></figure>
<p>使用下面的命令, 运行所有PENDING状态的的移植脚本,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix ecto.migrate Repo</span><br></pre></td></tr></table></figure>
<p>回滚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix ecto.rollback Repo --all</span><br></pre></td></tr></table></figure>
<p>Ecto的更多信息可以到<a href="https://github.com/elixir-lang/ecto" target="_blank" rel="external">Github上的Ecto项目</a>上获取, 或阅读<a href="http://elixir-lang.org/docs/ecto/" target="_blank" rel="external">Ecto文档</a></p>
<h2 id="创建项目">创建项目</h2><p>简单介绍Ecto后, 是时候在项目中使用了. 下面创建一个名为 <code>elixir_jobs</code>的项目:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix new elixir_jobs&#10;cd exlixir_jobs</span><br></pre></td></tr></table></figure>
<h3 id="安装Ecto">安装Ecto</h3><p>打开 <code>mix.exs</code> 文件. 需要<code>postgresql</code>驱动作为依赖, 这里我们使用<code>postgrex</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defp deps do&#10;    [&#123;:postgrex, &#34;0.5.2&#34;&#125;,&#10;     &#123;:ecto, &#34;0.2.0&#34;&#125;&#10;    ]&#10;end</span><br></pre></td></tr></table></figure>
<p>更新应用程序列表包含<code>ecto</code>和<code>postgrex</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def application do&#10;    [applications: [:postgrex, :ecto]]&#10;end</span><br></pre></td></tr></table></figure>
<p>终端中运行<code>mix deps.get</code>获取依赖.</p>
<h3 id="添加库(Repository)">添加库(Repository)</h3><p>A repo in ecto terms is the definition of a basic interface to a database,<br>in this case PostgreSQL. Open up lib/elixir_jobs/repo.ex and add the code below.<br>If the directory doesn’t exist, create it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule ElixirJobs.Repo do&#10;    use Ecto.Repo, adapter: Ecto.Adapters.Postgres&#10;    def conf do&#10;        parse_url &#34;ecto://postgresuser:password@localhost/elixir_jobs&#34;&#10;    end&#10;    def priv do&#10;        app_dir(:elixir_jobs, &#34;priv/repo&#34;)&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>我们定义了PostgreSQL连接URL.</p>
<p>你需要替换的时<code>postgresuser</code>, <code>password</code>和<code>elixir_jobs</code>数据库名称. 我们使用了移植功能,所以<code>priv</code>函数是必须的.</p>
<p>我们只需要告诉Ecto移植脚本放在什么位置, 这个位置是<code>priv/repo</code>.</p>
<p>接下来, 我们应该确保Repo模块随我们的应用程序一起启动. 打开<code>lib/elixir_jobs.ex</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule ElixirJobs do&#10;    use Application&#10;&#10;    def start(_type, _args) do&#10;        import Supervisor.Spec&#10;        tree = [worker(ElixirJobs,Repo, [])]&#10;        opts = [name: ElixirJobs.Sup, strategy: :one_for_one]&#10;        Supervisor.start_link(tree, opts)&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>确保一切OK, 让我们编译该项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix compile</span><br></pre></td></tr></table></figure>
<p>如果没有错误消息, 然后我们需要使用<code>psql</code>工具添加数据库<code>elixir_jobs</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#62; psql -Upostgresuser -W template1&#10;Password for user postgresuser:&#10;template1=# CREATE DATABASE elixir_jobs;&#10;CREATE DATABASE&#10;template1=# \q</span><br></pre></td></tr></table></figure>
<p>使用<code>\q</code>退出<code>psql</code>, 然后添加一个模型用于查询.</p>
<h3 id="添加模型(Models)">添加模型(Models)</h3><p>创建一个单独的文件 <code>lib/elixir_jobs/jobs.ex</code>,并输入下面的代码, 模型名称为<code>Jobs</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule ElixirJobs.Jobs do&#10;    use Ecto.Model&#10;&#10;    schema &#34;jobs&#34; do&#10;        field :title, :string&#10;        field :type, :string&#10;        field :description, :string&#10;        field :status, :string&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>运行<code>mix help</code>可以看到一组用于移植的命令</p>
<h3 id="生成移植(Migration)脚本">生成移植(Migration)脚本</h3><p>我们使用 <code>mix ecto.gen.migration</code>生成移植脚本, 首先使用下面的命令创建一个移植脚本.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#62; mix ecto.gen.migration ElixirJobs.Repo create_job&#10;* creating priv/repo/migrations&#10;* creating priv/repo/migrations/20140802043823_create_job.exs</span><br></pre></td></tr></table></figure>
<p>打开生成的<code>priv/repo/migrations/20140802043823_create_job.exs</code>文件. 在这个文件中, 我们还必须手工编写SQL命令用于创建和删除表.</p>
<p>文件名<code>20140802043823_create_job.exs</code>依据生成的时间变化.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule ElixirJobs.Repo.Migrations.CreateJob do&#10;  use Ecto.Migration&#10;  def up do&#10;    &#34;CREATE TABLE jobs(id serial primary key, title varchar(125), type varchar(50), description text, status varchar(50))&#34;&#10;  end&#10;  def down do&#10;    &#34;DROP TABLE jobs&#34;&#10;  end&#10;end</span><br></pre></td></tr></table></figure>
<p>创建了移植脚本后, 我们就可以运行它了.</p>
<h3 id="移植">移植</h3><p>运行移植非常容易, 像这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#62; mix ecto.migrate ElixirJobs.Repo&#10;* running UP _build/dev/lib/elixir_jobs/priv/repo/migrations/20140802043823_create_job.exs</span><br></pre></td></tr></table></figure>
<p>就这样! 如果你打开<code>elixir_jobs</code>数据库, 你会发现一个<code>jobs</code>表, 如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> Column    |          Type          |                     Modifiers&#10;-------------+----------------------+---------------------------------------------------&#10; id        | integer                | not null default nextval(&#39;jobs_id_seq&#39;::regclass)&#10; title     | character varying(125) |&#10; type      | character varying(50)  |&#10; description| text                   |&#10; status    | character varying(50)  |</span><br></pre></td></tr></table></figure>
<p>现在可以测试一下INSERT, UPDATE, DELETE以及SELECT操作了.</p>
<h3 id="实际操作">实际操作</h3><p>启动<code>iex</code>测试我们的设置. 开始操作数据库之前, 需要使用<code>start_link</code>函数启动库(Repo), 否则会得到一个错误.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#62; iex -S mix&#10;Erlang/OTP 17 [erts-6.0] [source] [64-bit] [smp:4:4] [async-threads:10] [hipe] [kernel-poll:false]&#10;Interactive Elixir (0.14.1) - press Ctrl+C to exit (type h() ENTER for help)&#10;iex(1)&#62; ElixirJobs.Repo.start_link&#10;&#123;:ok, #PID&#60;0.108.0&#62;&#125;</span><br></pre></td></tr></table></figure>
<p>如果返回<code>:ok</code>, 那么就可以使用定义模型时Ecto生成的结构插入数据了.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(2)&#62; job = %ElixirJobs.Jobs&#123;title: &#34;Elixir Expert Needed&#34;, description: &#34;ElixirDose need your help to produce a high quality Elixir article every month or two.&#34;, type: &#34;Remote&#34;, status: &#34;Part Time&#34;&#125;&#10;iex(3)&#62; ElixirJobs.Repo.insert(job)&#10;%ElixirJobs.Jobs&#123;description: &#34;ElixirDose need your help to produce a high quality Elixir article every month or two.&#34;, id: 2, status: &#34;Part Time&#34;, title: &#34;Elixir Expert Needed&#34;, type: &#34;Remote&#34;&#125;</span><br></pre></td></tr></table></figure>
<p>打开<code>jobs</code>表, 就可以看到刚刚插入的数据. 现在来读取数据:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(4)&#62; ejob = Repo.get(ElixirJobs.Jobs, 1)&#10;%ElixirJobs.Jobs&#123;description: &#34;ElixirDose need your help to produce a high quality Elixir article every month or two.&#34;, id: 1, status: &#34;Part Time&#34;, title: &#34;Elixir Expert Needed&#34;, type: &#34;Remote&#34;&#125;&#10;iex(5)&#62; ejob.title&#10;&#34;Elixir Expert Needed&#34;</span><br></pre></td></tr></table></figure>
<p>然后更新数据:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(6)&#62; ejob = %&#123;ejob | title: &#34;Elixir Writer Needed&#34;&#125;&#10;%ElixirJobs.Jobs&#123;description: &#34;ElixirDose need your help to produce a high quality Elixir article every month or two.&#34;, id: 1, status: &#34;Part Time&#34;, title: &#34;Elixir Writer Needed&#34;, type: &#34;Remote&#34;&#125;&#10;iex(7)&#62; ElixirJobs.Repo.update(ejob)&#10;:ok</span><br></pre></td></tr></table></figure>
<p>验证数据已经被更新:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(8)&#62; ElixirJobs.Repo.get(Jobs, 1)&#10;%ElixirJobs.Jobs&#123;description: &#34;ElixirDose need your help to produce a high quality Elixir article every month or two.&#34;, d: 1, status: &#34;Part Time&#34;, title: &#34;Elixir Writer Needed&#34;, type: &#34;Remote&#34;&#125;</span><br></pre></td></tr></table></figure>
<p>现在, 删除数据:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(9)&#62; ElixirJobs.Repo.delete(ejob)&#10;:ok&#10;iex(10)&#62; ElixirJobs.Repo.get(Jobs, 1)&#10;nil</span><br></pre></td></tr></table></figure>
<h2 id="总结">总结</h2><p>本文涵盖了Ecto的基本使用, 用DSL编写查询,以及和数据库交互.</p>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="https://github.com/elixir-lang/ecto" target="_blank" rel="external">https://github.com/elixir-lang/ecto</a></li>
<li><a href="http://www.youtube.com/watch?v=SJRfujy9vLA" target="_blank" rel="external">http://www.youtube.com/watch?v=SJRfujy9vLA</a></li>
<li><a href="http://elixirsips.com/episodes/024_ecto_part_1.html" target="_blank" rel="external">http://elixirsips.com/episodes/024_ecto_part_1.html</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-15T14:09:38.000Z"><a href="/2015/01/15/make-app-icns-images-using-iconutil-command-line/">2015-01-15</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/15/make-app-icns-images-using-iconutil-command-line/">使用iconutil命令行工具制作App图标</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>iconutil是一个命令行工具, 用于在<code>.iconset</code>文件(实际上是一个图标集目录)和<code>.icns</code>文件之间转换.</p>
<p>用到的图片可以从这里下载:</p>
<p><a href="https://github.com/andrevvm/appicns" target="_blank" rel="external">https://github.com/andrevvm/appicns</a></p>
<p>比如下面的命令, 把一个<code>1024x1024</code>的<code>netbook.icns</code>文件</p>
<pre><code><span class="tag">iconutil</span> <span class="tag">-c</span> <span class="tag">iconset</span> <span class="tag">-o</span> <span class="tag">output</span><span class="class">.iconset</span> <span class="tag">netbook</span><span class="class">.icns</span>
</code></pre><p>这个命令很简单,可以通过manpage查看:</p>
<pre><code><span class="keyword">man</span> iconutil
</code></pre><p>语法:</p>
<pre><code>iconutil -c {icns | iconset} [-o <span class="type">file</span>] <span class="type">file</span>
</code></pre><h2 id="生成的图标集效果">生成的图标集效果</h2><p><img src="/assets/images/9CA1D34F-1A00-47B3-A65A-EBB0636CF617.png" alt="图标集"></p>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="http://stackoverflow.com/questions/12306223/how-to-manually-create-icns-files-using-iconutil" target="_blank" rel="external">http://stackoverflow.com/questions/12306223/how-to-manually-create-icns-files-using-iconutil</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-14T02:23:11.000Z"><a href="/2015/01/14/erlang-ranch-listeners/">2015-01-14</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/14/erlang-ranch-listeners/">Erlang Ranch - 监听器</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>Ranch 是一个Erlang Tcp服务器Acceptor池的实现.</p>
<p>监听器是一组进程, 其角色是在端口上监听新连接. 它管理一个Acceptor进程池,每个Acceptor阻塞,知道有新的连接请求到达</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-08T07:50:36.000Z"><a href="/2015/01/08/elixir-sublime-autocomplete-issue/">2015-01-08</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/08/elixir-sublime-autocomplete-issue/">ElixirSublime 代码补全功能的异常问题.</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>最开始的问题是:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):&#10;  File &#34;/Applications/Sublime Text.app/Contents/MacOS/sublime_plugin.py&#34;, line 358, in on_query_completions&#10;    res = callback.on_query_completions(v, prefix, locations)&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 270, in on_query_completions&#10;    if not session.send(&#39;COMPLETE&#39;, expand_selection(view, locations[0], aliases=aliases)):&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 189, in send&#10;    self.socket.send(str.encode(cmd))&#10;AttributeError: &#39;NoneType&#39; object has no attribute &#39;send&#39;&#10;Traceback (most recent call last):&#10;  File &#34;/Applications/Sublime Text.app/Contents/MacOS/sublime_plugin.py&#34;, line 311, in on_activated_async&#10;    callback.on_activated_async(v)&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 255, in on_activated_async&#10;    self.on_load_async(view)&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 260, in on_load_async&#10;    ElixirSession.ensure(os.path.dirname(filename))&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 160, in ensure&#10;    session.connect()&#10;  File &#34;/Users/user/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/elixir_sublime.py&#34;, line 179, in connect&#10;    self.socket, _ = _socket.accept()&#10;  File &#34;./socket.py&#34;, line 135, in accept&#10;socket.timeout: timed out</span><br></pre></td></tr></table></figure>
<p>ElixirSublime日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;_io.TextIOWrapper name=&#39;/var/folders/m3/vn1yyrfx7l36cq6p8msc6wt80000gn/T/ElixirSublime.log&#39; mode=&#39;w&#39; encoding=&#39;US-ASCII&#39;&#62;</span><br></pre></td></tr></table></figure>
<p>通过Sublime的日志文件看到ElixirSublime使用了一个Mix项目<code>~/Library/Application Support/Sublime Text 3/Packages/ElixirSublime/sublime_completion</code>,<br>其中需要的依赖<code>poison</code>没找到, 我就进入这个执行了一下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix deps.get</span><br></pre></td></tr></table></figure>
<p>结果又冒出一个证书问题.</p>
<p><img src="/assets/elixir/hex.im-certificate-not-trusted.jpg" alt="hex.pm的证书不可信"></p>
<p>上述问题, 请参考<a href="/2015/01/08/elixir-hex-certificate-not-trusted">Elixir 在Mac OS X上安装Hex.pm服务器证书不信任的问题</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-08T07:32:31.000Z"><a href="/2015/01/08/elixir-hex-certificate-not-trusted/">2015-01-08</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/08/elixir-hex-certificate-not-trusted/">Elixir 在Mac OS X上安装Hex.pm服务器证书不信任的问题</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>我的Mac OS X是用的MacPorts作为第三方软件包的管理器.</p>
<p>wget是通过MacPorts安装的, 默认是不会包含服务器根证书的, 需要通过如下命令安装:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo port install curl-ca-bundle</span><br></pre></td></tr></table></figure>
<h2 id="参考资料:">参考资料:</h2><ol>
<li><a href="http://blog.55minutes.com/2012/01/fixing-https-certificate-errors-in-wget-and-ruby/" target="_blank" rel="external">http://blog.55minutes.com/2012/01/fixing-https-certificate-errors-in-wget-and-ruby/</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-06T15:41:45.000Z"><a href="/2015/01/06/elixir-mix-test/">2015-01-06</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/06/elixir-mix-test/">Elixir ExUnit测试</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>Mix的测试过程</p>
<ul>
<li>Mix首先启动应用程序</li>
<li>Mix然后查找项目根目录下的<code>test</code>子目录, 查找模式为<code>test/**/_test.exs</code>, 所有匹配这个模式的Elixir脚本都本认为是测试代码.</li>
</ul>
<h2 id="给测试方法打标签">给测试方法打标签</h2><p>有的时候,为了加速测试过程,我们需要过滤那些依赖外部资源的测试,为此,我们可以给测试打上标签,排除那些标记为<code>ignore</code>的测试.</p>
<p>首先需要在测试配置文件<code>test/test_helper.exs</code>中添加如下一行,用于排除外部测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExUnit.configure exclude: [ignore: true]</span><br></pre></td></tr></table></figure>
<p>不依赖外部资源的代码都通过测试后, 如果你还需要做一次整体测试, 可以通过参数, 把标记为<code>ignore</code>,值为<code>true</code>的测试包含进来.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix test --include ignore:true</span><br></pre></td></tr></table></figure>
<p>也可以指定所有包含标签<code>ignore</code>的测试,而不管其值是什么</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix test --include ignore</span><br></pre></td></tr></table></figure>
<h2 id="配置测试">配置测试</h2><ul>
<li><code>:test_paths</code> 指定测试代码的位置列表, 默认为<code>[&quot;test&quot;]</code>, 每个测试路径下面都应该包含一个<code>test_helper.exs</code>文件.</li>
<li><code>:test_pattern</code> 测试匹配模式, 默认为<code>*_test.exs</code></li>
<li><code>:test_coverage</code> 测试覆盖率选项</li>
</ul>
<h2 id="给测试打标记">给测试打标记</h2><p><img src="/assets/elixir/FB52C36C-1100-4CAA-B430-C4D932CEDBBE.png" alt="给测试打上@ignore标记"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix test --trace --exclude ignore:true</span><br></pre></td></tr></table></figure>
<p><img src="/assets/elixir/36FC718B-1167-4E3B-BCB2-9B8F06AE698C.jpg" alt="运行结果"></p>
<p>关于测试的详细配置和说明,请参考<code>mix help test</code></p>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="http://stackoverflow.com/questions/26150146/how-can-i-make-mix-run-only-specific-tests-from-my-suite-of-tests" target="_blank" rel="external">http://stackoverflow.com/questions/26150146/how-can-i-make-mix-run-only-specific-tests-from-my-suite-of-tests</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-05T13:49:11.000Z"><a href="/2015/01/05/erlang-hipe-help-options/">2015-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/05/erlang-hipe-help-options/">Erlang HiPE选项</a></h1>
  

    </header>
    <div class="entry">
      


        


        <ul>
<li><p>在编译期间输出内部调试信息</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4&#62; hipe:help_option(debug).&#10;debug - Outputs internal debugging information during compilation</span><br></pre></td></tr></table></figure>
</li>
<li><p>自动加载产生的原生代码到内存中</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5&#62; hipe:help_option(load).&#10;load - Automatically load the produced native code into memory</span><br></pre></td></tr></table></figure>
</li>
<li><p>Displays assembly listing with addresses and bytecode</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6&#62; hipe:help_option(pp_asm).&#10;pp_asm - Displays assembly listing with addresses and bytecode&#10;Currently available for x86 only</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示输入BEAM代码</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7&#62; hipe:help_option(pp_beam).&#10;pp_beam - Display the input BEAM code</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示中间HiPE-ICode代码</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8&#62; hipe:help_option(pp_icode).&#10;pp_icode - Display the intermediate HiPE-ICode</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示生成的(后端相关)原生代码</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9&#62; hipe:help_option(pp_native).&#10;pp_native - Display the generated (back-end specific) native code</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示中间HiPE-RTL代码</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10&#62; hipe:help_option(pp_rtl).&#10;pp_rtl - Display the intermediate HiPE-RTL code</span><br></pre></td></tr></table></figure>
</li>
<li><p>报告编译器不同阶段的编译时间</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12&#62; hipe:help_option(time).&#10;time - Reports the compilation times for the different stages&#10;of the compiler.&#10;    &#123;time, Module&#125;       reports timings for the module Module.&#10;    &#29305;&#23450;&#27169;&#22359;&#10;    &#123;time, [M1, M2, M3]&#125; reports timings for the specified modules.&#10;    &#25351;&#23450;&#27169;&#22359;&#21015;&#34920;&#10;    &#123;time, all&#125;          reports timings all modules.&#10;    &#25152;&#26377;&#27169;&#22359;&#10;    time                 reports timings for the main module.&#10;    &#20027;&#27169;&#22359;</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定编译时间限制,单位毫秒, 必须为非负整数, 或原子’infinity’, 当前默认限制为15分钟(900000毫秒)</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13&#62; hipe:help_option(timeout).&#10;timeout - Specify compilation time limit in ms. Used as &#123;timeout, LIMIT&#125;.&#10;    The limit must be a non-negative integer or the atom &#39;infinity&#39;.&#10;    The current default limit is 15 minutes (900000 ms).</span><br></pre></td></tr></table></figure>
</li>
<li><p>输出完成了什么</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">14&#62; hipe:help_option(verbose).&#10;verbose - Output information about what is being done</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-04T18:21:41.000Z"><a href="/2015/01/05/elixir-converting-erlang-code-to-elixir/">2015-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/05/elixir-converting-erlang-code-to-elixir/">Elixir 把Erlang代码转换为Elixir</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>项目地址:</p>
<p><a href="https://github.com/developerworks/ws_cowboy" target="_blank" rel="external">https://github.com/developerworks/ws_cowboy</a></p>
<h2 id="项目描述文件mix-exs">项目描述文件<code>mix.exs</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule WsCowboy.Mixfile do&#10;  use Mix.Project&#10;  def project do&#10;    [app: :ws_cowboy,&#10;     version: &#34;0.0.1&#34;,&#10;     elixir: &#34;~&#62; 1.0&#34;,&#10;     deps: deps]&#10;  end&#10;  def application do&#10;    [&#10;      applications: [:logger, :cowboy],&#10;      mod: &#123;WsCowboy, []&#125;&#10;    ]&#10;  end&#10;  defp deps do&#10;    [&#123;:cowboy,&#34;~&#62; 1.0.0&#34;&#125;]&#10;  end&#10;end</span><br></pre></td></tr></table></figure>
<h2 id="Application">Application</h2><p><img src="/assets/elixir/F12C0B50-7202-4D66-9F6D-90653C9F1BAC.png" alt="Application"></p>
<h2 id="Supervisor">Supervisor</h2><p><img src="/assets/elixir/A80E3448-29CE-421F-882F-D1E6FBBBCAB1.png" alt="Supervisor"></p>
<h2 id="Websocket_Handler">Websocket Handler</h2><p><img src="/assets/elixir/1A369D10-7585-4B51-805D-C289B1F8C8AD.png" alt="Websocket Handler"></p>
<h2 id="运行结果">运行结果</h2><p><img src="/assets/elixir/4CB26FF2-B581-4125-9A90-82AAC005C4D5.png" alt="运行结果"></p>
<h2 id="参考资料">参考资料</h2><ol>
<li>Converting Erlang code into Elixir<br><a href="http://blog.plataformatec.com.br/2014/11/converting-erlang-code-into-elixir/" target="_blank" rel="external">http://blog.plataformatec.com.br/2014/11/converting-erlang-code-into-elixir/</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-04T18:12:56.000Z"><a href="/2015/01/05/elixir-tips-001/">2015-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/05/elixir-tips-001/">Elixir提示 001</a></h1>
  

    </header>
    <div class="entry">
      


        


        <h2 id="模块">模块</h2><ul>
<li>Elixir代码可以组织到模块中</li>
<li>模块是函数的集合</li>
<li>模块是最小编译单元: 每个模块经过编译会生成一个<code>.beam</code>文件</li>
<li>通常在一个Elixir源文件中只定义一个模块,但也可以在一个源文件中定义多个模块,不管在源文件中有多少个模块,反正每个模块都会生成一个<code>.beam</code>文件,这种情况是一个编译输入文件产生多个编译输出文件</li>
</ul>
<h2 id="unless语句">unless语句</h2><p>unless语句为if语句的<code>反义</code></p>
<p>举例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Test1 do&#10;    def run do&#10;        if true do&#10;            IO.puts &#34;true&#34;&#10;        else&#10;            IO.puts &#34;false&#34;&#10;        end&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>当表达式1+1==2为真时, 执行if…end之间的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule Test2 do&#10;    def run do&#10;        unless true do&#10;            IO.puts &#34;true&#34;&#10;        else&#10;            IO.puts &#34;false&#34;&#10;        end&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>请把Test1和Test2模块代码复制粘贴到IEx中观察却别</p>
<h2 id="参考资料">参考资料</h2><ol>
<li><a href="http://stackoverflow.com/questions/25414347/how-do-i-run-a-beam-file-compiled-by-elixir-or-erlang" target="_blank" rel="external">http://stackoverflow.com/questions/25414347/how-do-i-run-a-beam-file-compiled-by-elixir-or-erlang</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-04T17:23:31.000Z"><a href="/2015/01/05/erlang-build-release-with-erlang-mk-and-relx/">2015-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/05/erlang-build-release-with-erlang-mk-and-relx/">Erlang 用erlang.mk和relx发布Erlang应用程序(译)</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>发布OTP应用程序一直是个困难的任务. 像<code>reltool</code>,<code>rebar</code>这类工具虽然简化了这类问题,但并没有解决所有问题.本文展示了一个候选方案,希望是一个更简化的方案.</p>
<p>发布OTP应用程序需要两个步骤.</p>
<ul>
<li>首先需要构建各种需要包含在发布包中的各种OTP应用程序.</li>
<li>构建完成后, 把<code>Erlang运行时系统</code>,<code>节点启动脚本</code>,<code>应用程序</code>和<code>配置文件</code>打包为一个可发布的软件包.</li>
</ul>
<p><a href="https://github.com/extend/erlang.mk" target="_blank" rel="external">erlang.mk</a>解决了第一个步骤的问题.它是一个<code>GNU Make</code>包含文件. 只需要把它包含在Makefile文件中即可构建项目,获取和构建依赖,构建文档,执行静态分析等任务.</p>
<p><a href="https://github.com/erlware/relx" target="_blank" rel="external">relx</a> 解决了第二个步骤的问题.它是一个发布创建工具, 用于把应用程序打包为单个可执行程序. 它并不要求配置文件, 如果你需要,那也是很小的一个配置文件.</p>
<p>来看一个最简单的使用erlang.mk的Makefile文件. 其只需要做一件事: 定义项目名称.</p>
<pre><code><span class="keyword">PROJECT</span> = my_peojct

<span class="keyword">include</span> erlang.mk
</code></pre><p>只需要这么定义就可以让你使用<code>make</code>命令来构建项目, 以及使用<code>make tests</code>运行测试. 如果使用<code>ErlyDTL</code>,它还可以构建<code>templates</code>目录中的<code>*.dtl</code>模板.</p>
<pre><code>PROJECT = ninenines

DEPS = cowboy erlydtl
dep_cowboy = https://github.com/extend/cowboy.git 0.8.5
dep_erlydtl = https://github.com/evanmiller/erlydtl.git 4d0dc8fb

.PHONY: <span class="operator"><span class="keyword">release</span> clean-<span class="keyword">release</span>

<span class="keyword">release</span>: clean-<span class="keyword">release</span> all projects
    relx -o rel/$(<span class="keyword">PROJECT</span>)

clean-<span class="keyword">release</span>: clean-projects
    rm -rf rel/$(<span class="keyword">PROJECT</span>)

<span class="keyword">include</span> erlang.mk</span>
</code></pre><p>其中我们看到了如何定义依赖<code>DEPS = cowboy erlydtl</code>:</p>
<ul>
<li>首先,列举所有的依赖名称</li>
<li>其次,单独定义每一个依赖的URL,提交号,标记或分支</li>
<li>随后,定义了两个目标, <code>release</code>为默认目标, 因为它是最先定义的. 你可以覆盖默认目标<code>all</code>,其作用是构建应用程序与其依赖.</li>
<li><code>release</code>目标使用<code>relx</code>在<code>rel/ninenines/</code>目录构建发布.</li>
</ul>
<p>下面来看一下构建此发布的配置文件.</p>
<pre><code>{release, {ninenines, <span class="string">"1"</span>}, [ninenines]}.

{extended_start_script, true}.
{sys_config, <span class="string">"rel/sys.config"</span>}.

{overlay, [
    {mkdir, <span class="string">"log"</span>},
    {copy, <span class="string">"rel/vm.args"</span>,
        <span class="string">"releases/\{\{release_name\}\}-\{\{release_version\}\}/vm.args"</span>}
]}.
</code></pre><p>第一行定义了一个名为<code>ninenines</code>的发布,其又一个版本号<code>1</code>, 包含一个应用程序,名称也为<code>ninenines</code>.</p>
<p>We then use the extended_start_script option to tell relx that we would like to have a start script that allows us to<br>not only start the release, but do so with the node in the background, or also to allow us to connect to a running node, and so on.<br>This start script has the same features as the one tools like rebar generates.</p>
<p>然后使用<code>extended_start_script</code>告知<code>relx</code>我们想要有一个启动脚本用于启动应用程序, …..<br>该启动脚本和<code>rebar</code>工具生成的作用是一样的.</p>
<h2 id="参考资料">参考资料</h2><ol>
<li>Build Erlang releases with erlang.mk and relx<br><a href="http://ninenines.eu/articles/erlang.mk-and-relx/" target="_blank" rel="external">http://ninenines.eu/articles/erlang.mk-and-relx/</a></li>
<li>erlang.mk Github项目<br><a href="https://github.com/ninenines/erlang.mk" target="_blank" rel="external">https://github.com/ninenines/erlang.mk</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-04T17:08:21.000Z"><a href="/2015/01/05/elixir-release-manager/">2015-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/05/elixir-release-manager/">Elixir发布管理器 Exrm</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>Elixir发布管理器(Elixir Release Manager)是一个Elixir任务模块,用于把一个完整Elixir项目打包为一个<code>.tar.gz</code>文件用于发布和部署.</p>
<p>首先, 需要在<code>mix.exs</code>文件中添加如下依赖:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defp deps do&#10;    [&#123;:exrm, &#34;~&#62; 0.14.16&#34;&#125;]&#10;end</span><br></pre></td></tr></table></figure>
<p>下载依赖,并编译</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix deps.get&#10;mix deps.compile</span><br></pre></td></tr></table></figure>
<p>发布项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix release</span><br></pre></td></tr></table></figure>
<pre><code>Build a <span class="operator"><span class="keyword">release</span> <span class="keyword">for</span> the <span class="keyword">current</span> mix application.

Examples

┃ # <span class="keyword">Build</span> a <span class="keyword">release</span> <span class="keyword">using</span> <span class="keyword">defaults</span>
┃ mix <span class="keyword">release</span>
┃
┃ # Pass args <span class="keyword">to</span> erlexec <span class="keyword">when</span> running the <span class="keyword">release</span>
┃ mix <span class="keyword">release</span> <span class="comment">--erl="-env TZ UTC"</span>
┃
┃ # <span class="keyword">Enable</span> dev <span class="keyword">mode</span>. Make changes, compile <span class="keyword">using</span> MIX_ENV=prod
┃ # <span class="keyword">and</span> <span class="keyword">execute</span> your <span class="keyword">release</span> again <span class="keyword">to</span> pick up the changes
┃ mix <span class="keyword">release</span> <span class="comment">--dev</span>
┃
┃ # <span class="keyword">Set</span> the verbosity <span class="keyword">level</span>
┃ mix <span class="keyword">release</span> <span class="comment">--verbosity=[silent|quiet|normal|verbose]</span>

You may pass <span class="keyword">any</span> <span class="built_in">number</span> <span class="keyword">of</span> arguments <span class="keyword">as</span> needed. Make sure you pass arguments
<span class="keyword">using</span> <span class="comment">--key=value, not --key value, as the args may be interpreted incorrectly</span>
otherwise.</span>
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2015-01-02T09:29:03.000Z"><a href="/2015/01/02/elixir-regex/">2015-01-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/02/elixir-regex/">Elixir 正则表达式</a></h1>
  

    </header>
    <div class="entry">
      


        
        <div id="toc" class="toc-article">
            <strong class="toc-title">文章目录</strong>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#定义正则表达式"><span class="toc-number">1.</span> <span class="toc-text">定义正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#验证手机号码"><span class="toc-number">2.</span> <span class="toc-text">验证手机号码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#验证电子邮件地址"><span class="toc-number">3.</span> <span class="toc-text">验证电子邮件地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#验证身份证号码"><span class="toc-number">4.</span> <span class="toc-text">验证身份证号码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">5.</span> <span class="toc-text">参考资料</span></a></li></ol>
        </div>
        


        <h2 id="定义正则表达式">定义正则表达式</h2><ul>
<li>在Elixir中定义正则表达式需要使用到一个特殊的前缀<code>~r</code></li>
<li>匹配操作需要使用操作符<code>=~</code></li>
</ul>
<h2 id="验证手机号码">验证手机号码</h2><p>比如我们定义一个验证11为手机号码的正则表达式,启动Elixir Shell, 定义一个手机号码的正则表达式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(1)&#62; regex_cellphone = ~r&#34;^[0-9]&#123;11,11&#125;$&#34;&#10;~r/^[0-9]&#123;11,11&#125;$/</span><br></pre></td></tr></table></figure>
<p>匹配:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(2)&#62; &#34;13912345678&#34; =~ regex_cellphone&#10;true</span><br></pre></td></tr></table></figure>
<p>在判断条件中使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(7)&#62; cond do&#10;...(7)&#62;   &#34;13912345678&#34; =~ regex_cellphone == true -&#62;&#10;...(7)&#62;     IO.puts &#34;Cellphone number 13912345678 is a valid cell phone number&#34;&#10;...(7)&#62;   true -&#62;&#10;...(7)&#62;     false&#10;...(7)&#62; end&#10;Cellphone number 13912345678 is a valid cell phone number&#10;:ok</span><br></pre></td></tr></table></figure>
<p>在关键业务中, 还需要通过短信验证手机号的有效性, 上述验证并不能保证该号码是一个<code>可用</code>的手机号码.</p>
<h2 id="验证电子邮件地址">验证电子邮件地址</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(13)&#62; str_email = &#34;riza@elixirdose.com&#34;&#10;&#34;riza@elixirdose.com&#34;&#10;iex(14)&#62; Regex.match?(~r/(\w+)@([\w.]+)/, str_email)&#10;true&#10;iex(15)&#62; cond do&#10;...(15)&#62;   Regex.match?(~r/(\w+)@([\w.]+)/, str_email) == true -&#62;&#10;...(15)&#62;    IO.puts &#34;Your email is a valid email&#34;&#10;...(15)&#62;   true -&#62;&#10;...(15)&#62;    IO.puts &#34;Your email address is invalid&#34;&#10;...(15)&#62; end&#10;Your email is a valid email&#10;:ok</span><br></pre></td></tr></table></figure>
<p>编译版本, 正则表达式有几个变化</p>
<ul>
<li><code>Regex.compile</code>编译正则表达式字符串不需要使用<code>~r</code>前缀</li>
<li><code>\</code>符号需要使用<code>\\</code>替代(转义)<br>上面在Elixir Shell中的正则表达式<code>~r/(\w+)@([\w.]+)/</code>需要改成字符串<code>(\\w+)@([\\w.]+)</code>, 对应的编译语句为<code>{:ok, regex} = Regex.compile(&quot;(\\w+)@([\\w.]+)&quot;)</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule RegExpTest do&#10;    def run(email_address) do&#10;        case Regex.compile(&#34;(\\w+)@([\\w.]+)&#34;) do&#10;            &#123;:ok, regex&#125; -&#62;&#10;                if Regex.match?(regex, email_address) == true do&#10;                    IO.puts &#34;Your email is a valid email&#34;&#10;                else&#10;                    IO.puts &#34;Your email address is invalid&#34;&#10;                end&#10;            _ -&#62;&#10;                IO.puts &#34;Invalid regex definition&#34;&#10;        end&#10;    end&#10;end</span><br></pre></td></tr></table></figure>
<p>在Elixir Shell中执行:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex(4)&#62; defmodule RegExpTest do&#10;...(4)&#62;     def run(email_address) do&#10;...(4)&#62;         case Regex.compile(&#34;(\\w+)@([\\w.]+)&#34;) do&#10;...(4)&#62;             &#123;:ok, regex&#125; -&#62;&#10;...(4)&#62;                 if Regex.match?(regex, email_address) == true do&#10;...(4)&#62;                     IO.puts &#34;Your email is a valid email&#34;&#10;...(4)&#62;                 else&#10;...(4)&#62;                     IO.puts &#34;Your email address is invalid&#34;&#10;...(4)&#62;                 end&#10;...(4)&#62;             _ -&#62;&#10;...(4)&#62;                 IO.puts &#34;Invalid regex definition&#34;&#10;...(4)&#62;         end&#10;...(4)&#62;     end&#10;...(4)&#62; end&#10;iex:4: warning: redefining module RegExpTest&#10;&#123;:module, RegExpTest,&#10; &#60;&#60;70, 79, 82, 49, 0, 0, 6, 160, 66, 69, 65, 77, 69, 120, 68, 99, 0, 0, 0, 122, 131, 104, 2, 100, 0, 14, 101, 108, 105, 120, 105, 114, 95, 100, 111, 99, 115, 95, 118, 49, 108, 0, 0, 0, 2, 104, 2, ...&#62;&#62;,&#10; &#123;:run, 1&#125;&#125;&#10;iex(5)&#62; RegExpTest.run(&#34;riza@elixirdose.com&#34;)&#10;Your email is a valid email&#10;:ok</span><br></pre></td></tr></table></figure>
<h2 id="验证身份证号码">验证身份证号码</h2><p>规则:</p>
<ul>
<li>身份证号码必须是18为字符长度,有17为数字本体码和1位校验码构成</li>
<li>本体码包含3个部分, 分别是<ul>
<li>地址(地区)码</li>
<li>出生日期</li>
<li>顺序码(男性奇数, 女性偶数)<br>在特定应用下,比如需要用户输入身份证号码的应用场景, 我们可以通过顺序吗识别用户的性别,减少用户输入.</li>
</ul>
</li>
</ul>
<p>TODO:: 实现</p>
<h2 id="参考资料">参考资料</h2><ol>
<li>验证邮件地址示例<br><a href="https://gist.github.com/rizafahmi/b1711f7f10aaf7a7ced9" target="_blank" rel="external">https://gist.github.com/rizafahmi/b1711f7f10aaf7a7ced9</a></li>
<li>身份证验证规则<br><a href="http://wenku.baidu.com/link?url=lSfaWKLcnVJTF7LYXOG5qdEhY_Ns5mBWyPu372WcskB7aII2UTzQ5UakYCIBENBy2LKTz0HftEr7boaFnFZcjjbHec_8Py708uqq9nfMmEW" target="_blank" rel="external">http://wenku.baidu.com/link?url=lSfaWKLcnVJTF7LYXOG5qdEhY_Ns5mBWyPu372WcskB7aII2UTzQ5UakYCIBENBy2LKTz0HftEr7boaFnFZcjjbHec_8Py708uqq9nfMmEW</a></li>
<li>常用语法,控制流语句<br><a href="http://learnxinyminutes.com/docs/zh-cn/elixir-cn/" target="_blank" rel="external">http://learnxinyminutes.com/docs/zh-cn/elixir-cn/</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <!--<div class="icon"></div>-->
        <time datetime="2014-12-31T19:04:01.000Z"><a href="/2015/01/01/elixir-how-to-parsing-xml/">2015-01-01</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/01/elixir-how-to-parsing-xml/">Elixir 解析XML的几个坑</a></h1>
  

    </header>
    <div class="entry">
      


        


        <p>在Elixir 1.0.2中解析XML文档的时候,最开始是参考的<a href="http://elixirsips.com/episodes/028_parsing_xml.html" target="_blank" rel="external">这个视频</a>, 总之在Google的搜索结果中掉进了无数多个坑后,终于爬出来了.</p>
<p>创建一个项目, 本文所述所有内容都是在文件<code>test/xml_parsing_test.exs</code>文件中完成, 并通过<code>mix test</code>执行测试用例:</p>
<pre><code>root<span class="variable">@c87c9967219c</span><span class="symbol">:~</span><span class="comment"># mix new xml_parsing</span>
* creating <span class="constant">README</span>.md
* creating .gitignore
* creating mix.exs
* creating config
* creating config/config.exs
* creating <span class="class"><span class="keyword">lib</span></span>
* creating <span class="class"><span class="keyword">lib</span>/<span class="title">xml_parsing</span>.<span class="title">ex</span></span>
* creating test
* creating test/test_helper.exs
* creating test/xml_parsing_test.exs

<span class="constant">Your</span> mix project was created successfully.
<span class="constant">You</span> can use mix to compile it, test it, and <span class="symbol">more:</span>

    cd xml_parsing
    mix test

<span class="constant">Run</span> <span class="string">`mix help`</span> <span class="keyword">for</span> more commands.
</code></pre><p>把我拉出来的是下面这篇<a href="http://erlangcentral.org/wiki/index.php?title=Elixir_and_XML" target="_blank" rel="external">Wiki</a>, 视频中的代码有几个问题:</p>
<ul>
<li><code>defrecord</code>关键字废弃了,必须用<code>Record.defrecord</code></li>
<li><p><code>Record.defrecord</code>不能定义在模块的外面了,必须定义在模块内部, 比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defmodule XmlParsingTest do&#10;    use ExUnit.Case&#10;    require Record&#10;    Record.defrecord :xmlElement, Record.extract(:xmlElement, from_lib: &#34;xmerl/include/xmerl.hrl&#34;)&#10;    Record.defrecord :xmlText, Record.extract(:xmlText, from_lib: &#34;xmerl/include/xmerl.hrl&#34;)&#10;    ...&#10;end</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取节点值的方式变了</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test &#34;Test parsing xml document OLD&#34; do&#10;    &#123;xml, _rest&#125;        = :xmerl_scan.string(:binary.bin_to_list(sample_xml))&#10;    [ title_element ]   = Enum.first(:xmerl_xpath.string(&#39;/blog/title&#39;, xml)).value&#10;    [ title_text ]      = title_element.content&#10;    title               = title_text.value&#10;    assert title == &#39;Using xmerl module to parse xml document in elixir&#39;&#10;end&#10;# &#23545;&#27604;&#19978;&#19979;&#20004;&#20010;&#27979;&#35797;&#26041;&#27861;&#30340;&#21306;&#21035;&#10;test &#34;Test parsing xml document NEW&#34; do&#10;    &#123;document, _&#125; = :xmerl_scan.string(String.to_char_list(sample_xml))&#10;    [element] = :xmerl_xpath.string(&#39;/blog/title/text()&#39;, document)&#10;    assert xmlText(element, :value)  == &#39;Using xmerl module to parse xml document in elixir&#39;&#10;end</span><br></pre></td></tr></table></figure>
<p>对比上面的代码, 我们通过<code>Record.defrecord</code>定义记录, 该记录是从Erlang的xmerl库中提取的(调用<code>Record.extract</code>), 该记录将作为测试模块的一个函数,我们可以通过下面的方法验证:</p>
<p>运行<code>iex</code>进入Elixir Shell, 并声明模块:</p>
<p><img src="http://developerworks.github.io/assets/elixir/671C1BC4-418A-4B67-9A35-5B0DDCA3E293.png" alt="导入xmerl模块的记录为Elixir模块函数"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test &#34;Test parsing xml document&#34; do&#10;    # &#35299;&#26512;XML&#25991;&#26723;&#10;    &#123;document, _&#125; = :xmerl_scan.string(String.to_char_list(sample_xml))&#10;    # XPATH&#26597;&#35810;&#10;    [element] = :xmerl_xpath.string(&#39;/blog/title/text()&#39;, document)&#10;    # &#26029;&#35328;&#10;    assert xmlText(element, :value)  == &#39;Using xmerl module to parse xml document in elixir&#39;&#10;end</span><br></pre></td></tr></table></figure>
<h2 id="完整的代码">完整的代码</h2><p><a href="https://gist.github.com/94ce9976fc52e04e572a" target="_blank" rel="external">https://gist.github.com/94ce9976fc52e04e572a</a></p>
<h2 id="完整的项目代码">完整的项目代码</h2><p><a href="https://github.com/developerworks/xml_parsing" target="_blank" rel="external">https://github.com/developerworks/xml_parsing</a></p>
<h2 id="参考资料">参考资料</h2><ol>
<li>ELIXIR AND XML<br><a href="http://erlangcentral.org/wiki/index.php?title=Elixir_and_XML" target="_blank" rel="external">http://erlangcentral.org/wiki/index.php?title=Elixir_and_XML</a></li>
<li>028: Parsing XML<br><a href="http://elixirsips.com/episodes/028_parsing_xml.html" target="_blank" rel="external">http://elixirsips.com/episodes/028_parsing_xml.html</a></li>
<li>常用的XML文档解析模块<br><a href="https://github.com/h4cc/awesome-elixir#xml" target="_blank" rel="external">https://github.com/h4cc/awesome-elixir#xml</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




<nav id="pagination">
  
    <a href="/" class="alignleft prev">上一页</a>
  
  
    <a href="/page/3/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div>
    </div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2015/11/02/elixir-failover-and-takeover/">故障转移和接管</a>
      </li>
    
      <li>
        <a href="/2015/09/17/ejabberd-with-elixir-mix/">用Elixir Mix构建Ejabberd发行包</a>
      </li>
    
      <li>
        <a href="/2015/06/05/uftp/">UFTP - 基于UDP的加密文件多播传输协议</a>
      </li>
    
      <li>
        <a href="/2015/06/04/html5-web-cryptography-api-hashing/">Web加密API - 散列(Hashing)</a>
      </li>
    
      <li>
        <a href="/2015/06/04/the-3-modes-of-http-protocol/">HTTP协议的三种模式</a>
      </li>
    
      <li>
        <a href="/2015/05/21/ejabberd-with-elixir-packet-filters/">Ejabberd 用Elixir开发一个包过滤模块</a>
      </li>
    
      <li>
        <a href="/2015/05/18/chrome-dev-get-started/">Chrome 开发入门</a>
      </li>
    
      <li>
        <a href="/2015/05/18/html5-web-cryptography-api-tutorial/">Web加密API指南</a>
      </li>
    
      <li>
        <a href="/2015/05/17/html5-battery-status/">HTML5获取电池状态</a>
      </li>
    
      <li>
        <a href="/2015/05/10/ejabberd-mam-module-how-to-use/">如何使用Ejabberd消息归档模块</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/AD/">AD</a><small>2</small></li>
  
    <li><a href="/categories/API/">API</a><small>3</small></li>
  
    <li><a href="/categories/Chrome/">Chrome</a><small>1</small></li>
  
    <li><a href="/categories/Continuous-Deployment/">Continuous Deployment</a><small>1</small></li>
  
    <li><a href="/categories/Database/">Database</a><small>1</small></li>
  
    <li><a href="/categories/Docker/">Docker</a><small>9</small></li>
  
    <li><a href="/categories/Ejabberd/">Ejabberd</a><small>36</small></li>
  
    <li><a href="/categories/Elixir/">Elixir</a><small>42</small></li>
  
    <li><a href="/categories/Erlang/">Erlang</a><small>20</small></li>
  
    <li><a href="/categories/HTML5/">HTML5</a><small>3</small></li>
  
    <li><a href="/categories/HTTP/">HTTP</a><small>1</small></li>
  
    <li><a href="/categories/HTTP2/">HTTP2</a><small>1</small></li>
  
    <li><a href="/categories/Javascript/">Javascript</a><small>14</small></li>
  
    <li><a href="/categories/Linux/">Linux</a><small>4</small></li>
  
    <li><a href="/categories/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/categories/Node-js/">Node.js</a><small>17</small></li>
  
    <li><a href="/categories/Opencart/">Opencart</a><small>2</small></li>
  
    <li><a href="/categories/QA/">QA</a><small>2</small></li>
  
    <li><a href="/categories/RESTFul/">RESTFul</a><small>1</small></li>
  
    <li><a href="/categories/SCM/">SCM</a><small>5</small></li>
  
    <li><a href="/categories/Testing/">Testing</a><small>1</small></li>
  
    <li><a href="/categories/Thrift/">Thrift</a><small>1</small></li>
  
    <li><a href="/categories/Tools/">Tools</a><small>4</small></li>
  
    <li><a href="/categories/Web/">Web</a><small>6</small></li>
  
    <li><a href="/categories/XEP/">XEP</a><small>5</small></li>
  
    <li><a href="/categories/XMPP/">XMPP</a><small>7</small></li>
  
    <li><a href="/categories/english/">english</a><small>1</small></li>
  
    <li><a href="/categories/杂类/">杂类</a><small>1</small></li>
  
  </ul>
</div>


  

  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/AD/" style="font-size: 10px;">AD</a> <a href="/tags/API/" style="font-size: 11.11px;">API</a> <a href="/tags/Analysis/" style="font-size: 10px;">Analysis</a> <a href="/tags/Battery-Status/" style="font-size: 10px;">Battery Status</a> <a href="/tags/Behaviour/" style="font-size: 10px;">Behaviour</a> <a href="/tags/CUPS/" style="font-size: 10px;">CUPS</a> <a href="/tags/CURL/" style="font-size: 10px;">CURL</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/Clustering/" style="font-size: 10px;">Clustering</a> <a href="/tags/Distributed/" style="font-size: 10px;">Distributed</a> <a href="/tags/Distributed-Application/" style="font-size: 10px;">Distributed Application</a> <a href="/tags/ETS/" style="font-size: 10px;">ETS</a> <a href="/tags/Ecto/" style="font-size: 11.11px;">Ecto</a> <a href="/tags/Elixir/" style="font-size: 20px;">Elixir</a> <a href="/tags/Erlang/" style="font-size: 10px;">Erlang</a> <a href="/tags/Escalus/" style="font-size: 10px;">Escalus</a> <a href="/tags/ExUnit/" style="font-size: 10px;">ExUnit</a> <a href="/tags/Exrm/" style="font-size: 10px;">Exrm</a> <a href="/tags/H2O/" style="font-size: 10px;">H2O</a> <a href="/tags/Hex-pm/" style="font-size: 10px;">Hex.pm</a> <a href="/tags/HiPE/" style="font-size: 10px;">HiPE</a> <a href="/tags/Howto/" style="font-size: 10px;">Howto</a> <a href="/tags/Http-modes/" style="font-size: 10px;">Http modes</a> <a href="/tags/Httpotion/" style="font-size: 10px;">Httpotion</a> <a href="/tags/I18n/" style="font-size: 10px;">I18n</a> <a href="/tags/IAB/" style="font-size: 10px;">IAB</a> <a href="/tags/ID3/" style="font-size: 10px;">ID3</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/IOT/" style="font-size: 10px;">IOT</a> <a href="/tags/IoT/" style="font-size: 10px;">IoT</a> <a href="/tags/Loopback/" style="font-size: 12.22px;">Loopback</a> <a href="/tags/MUC/" style="font-size: 10px;">MUC</a> <a href="/tags/Macro/" style="font-size: 12.22px;">Macro</a> <a href="/tags/Memcache/" style="font-size: 10px;">Memcache</a> <a href="/tags/Mix/" style="font-size: 14.44px;">Mix</a> <a href="/tags/Modules/" style="font-size: 10px;">Modules</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/OSM-Building/" style="font-size: 10px;">OSM Building</a> <a href="/tags/OTP/" style="font-size: 12.22px;">OTP</a> <a href="/tags/OpenStreetMap/" style="font-size: 10px;">OpenStreetMap</a> <a href="/tags/Optimization/" style="font-size: 10px;">Optimization</a> <a href="/tags/PM2/" style="font-size: 10px;">PM2</a> <a href="/tags/Performance/" style="font-size: 10px;">Performance</a> <a href="/tags/Phoenix/" style="font-size: 12.22px;">Phoenix</a> <a href="/tags/Pool/" style="font-size: 10px;">Pool</a> <a href="/tags/PostgreSQL/" style="font-size: 10px;">PostgreSQL</a> <a href="/tags/RESTFUL/" style="font-size: 11.11px;">RESTFUL</a> <a href="/tags/RMAL/" style="font-size: 10px;">RMAL</a> <a href="/tags/Ranch/" style="font-size: 10px;">Ranch</a> <a href="/tags/RefactorErl/" style="font-size: 10px;">RefactorErl</a> <a href="/tags/Regex/" style="font-size: 10px;">Regex</a> <a href="/tags/Resource-Pool/" style="font-size: 10px;">Resource Pool</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/SSL/" style="font-size: 10px;">SSL</a> <a href="/tags/SemVer/" style="font-size: 10px;">SemVer</a> <a href="/tags/Semantic-UI/" style="font-size: 10px;">Semantic UI</a> <a href="/tags/Sequelize/" style="font-size: 10px;">Sequelize</a> <a href="/tags/Stream-Management/" style="font-size: 10px;">Stream Management</a> <a href="/tags/Sublime/" style="font-size: 10px;">Sublime</a> <a href="/tags/Task/" style="font-size: 10px;">Task</a> <a href="/tags/Thrift/" style="font-size: 11.11px;">Thrift</a> <a href="/tags/Tsung/" style="font-size: 10px;">Tsung</a> <a href="/tags/UBF/" style="font-size: 10px;">UBF</a> <a href="/tags/UFTP/" style="font-size: 10px;">UFTP</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/Umbrella/" style="font-size: 10px;">Umbrella</a> <a href="/tags/VAST/" style="font-size: 10px;">VAST</a> <a href="/tags/VPAID/" style="font-size: 10px;">VPAID</a> <a href="/tags/Web-Cryptography-API/" style="font-size: 11.11px;">Web Cryptography API</a> <a href="/tags/XEP/" style="font-size: 16.67px;">XEP</a> <a href="/tags/XEP-198/" style="font-size: 10px;">XEP-198</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XMPP/" style="font-size: 17.78px;">XMPP</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/angular/" style="font-size: 16.67px;">angular</a> <a href="/tags/application/" style="font-size: 10px;">application</a> <a href="/tags/blockies/" style="font-size: 10px;">blockies</a> <a href="/tags/bootstrap3/" style="font-size: 10px;">bootstrap3</a> <a href="/tags/bosh/" style="font-size: 12.22px;">bosh</a> <a href="/tags/ci/" style="font-size: 10px;">ci</a> <a href="/tags/container/" style="font-size: 11.11px;">container</a> <a href="/tags/data-management/" style="font-size: 10px;">data management</a> <a href="/tags/data-volume/" style="font-size: 10px;">data volume</a> <a href="/tags/debugging/" style="font-size: 10px;">debugging</a> <a href="/tags/devtools/" style="font-size: 10px;">devtools</a> <a href="/tags/devtools-terminal/" style="font-size: 10px;">devtools-terminal</a> <a href="/tags/doc/" style="font-size: 10px;">doc</a> <a href="/tags/docker/" style="font-size: 15.56px;">docker</a> <a href="/tags/ejabberd/" style="font-size: 18.89px;">ejabberd</a> <a href="/tags/ejabberd-c2s/" style="font-size: 10px;">ejabberd_c2s</a> <a href="/tags/emysql/" style="font-size: 11.11px;">emysql</a> <a href="/tags/encoding/" style="font-size: 10px;">encoding</a> <a href="/tags/erlang/" style="font-size: 12.22px;">erlang</a> <a href="/tags/erlang-mk/" style="font-size: 10px;">erlang.mk</a> <a href="/tags/faq/" style="font-size: 10px;">faq</a> <a href="/tags/gen-tcp/" style="font-size: 10px;">gen_tcp</a> <a href="/tags/gerrit/" style="font-size: 11.11px;">gerrit</a> <a href="/tags/gettext/" style="font-size: 10px;">gettext</a> <a href="/tags/git/" style="font-size: 12.22px;">git</a> <a href="/tags/graphviz/" style="font-size: 10px;">graphviz</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hero/" style="font-size: 10px;">hero</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/iconutil/" style="font-size: 10px;">iconutil</a> <a href="/tags/iq/" style="font-size: 10px;">iq</a> <a href="/tags/jabber/" style="font-size: 10px;">jabber</a> <a href="/tags/javascript/" style="font-size: 11.11px;">javascript</a> <a href="/tags/jiffy/" style="font-size: 10px;">jiffy</a> <a href="/tags/json-schema/" style="font-size: 10px;">json-schema</a> <a href="/tags/library/" style="font-size: 10px;">library</a> <a href="/tags/linking/" style="font-size: 10px;">linking</a> <a href="/tags/lists/" style="font-size: 10px;">lists</a> <a href="/tags/load-balance/" style="font-size: 10px;">load balance</a> <a href="/tags/log4er/" style="font-size: 10px;">log4er</a> <a href="/tags/manage-images/" style="font-size: 10px;">manage images</a> <a href="/tags/mariadb/" style="font-size: 10px;">mariadb</a> <a href="/tags/muc/" style="font-size: 10px;">muc</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/node-reggie/" style="font-size: 10px;">node-reggie</a> <a href="/tags/node-webkit/" style="font-size: 13.33px;">node-webkit</a> <a href="/tags/node-js/" style="font-size: 12.22px;">node.js</a> <a href="/tags/nodemailer/" style="font-size: 10px;">nodemailer</a> <a href="/tags/notification/" style="font-size: 10px;">notification</a> <a href="/tags/npm/" style="font-size: 11.11px;">npm</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/ploymer/" style="font-size: 10px;">ploymer</a> <a href="/tags/polymer/" style="font-size: 10px;">polymer</a> <a href="/tags/port/" style="font-size: 10px;">port</a> <a href="/tags/pubsub/" style="font-size: 10px;">pubsub</a> <a href="/tags/rebar/" style="font-size: 10px;">rebar</a> <a href="/tags/record/" style="font-size: 10px;">record</a> <a href="/tags/recursion/" style="font-size: 10px;">recursion</a> <a href="/tags/regexp/" style="font-size: 10px;">regexp</a> <a href="/tags/relx/" style="font-size: 10px;">relx</a> <a href="/tags/screen/" style="font-size: 10px;">screen</a> <a href="/tags/sequelize/" style="font-size: 10px;">sequelize</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/stanza/" style="font-size: 10px;">stanza</a> <a href="/tags/strophe-js/" style="font-size: 10px;">strophe.js</a> <a href="/tags/strophejs/" style="font-size: 10px;">strophejs</a> <a href="/tags/svg-sprite/" style="font-size: 10px;">svg-sprite</a> <a href="/tags/swagger/" style="font-size: 12.22px;">swagger</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a> <a href="/tags/tls/" style="font-size: 10px;">tls</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/tsung/" style="font-size: 10px;">tsung</a> <a href="/tags/upstart/" style="font-size: 10px;">upstart</a> <a href="/tags/vQmod/" style="font-size: 10px;">vQmod</a> <a href="/tags/varnish/" style="font-size: 10px;">varnish</a> <a href="/tags/vqmod/" style="font-size: 10px;">vqmod</a> <a href="/tags/vt/" style="font-size: 10px;">vt</a> <a href="/tags/win32reg/" style="font-size: 10px;">win32reg</a> <a href="/tags/xml-schema/" style="font-size: 10px;">xml schema</a> <a href="/tags/匆匆那年/" style="font-size: 10px;">匆匆那年</a> <a href="/tags/协议包/" style="font-size: 10px;">协议包</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
</div>
<footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 zhiqiang he
  
</div>
<div class="clearfix"></div></footer>

<!--<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>-->
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<!--<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });

</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });

</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });

</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-53429135-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>




